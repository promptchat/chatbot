(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{"19iC":function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u}));var a=n("rpa7"),r=n("J3gs"),i=n("YOdH"),l=n("gmZo"),o=n("q1tI");function c(){return function(e){return!e||e.is_am_pm?"hh:mm a":"HH:mm"}(Object(a.a)())}function s(){var e=Object(r.a)();return c()+" "+e}function u(){var e=Object(i.a)(),t=s();return Object(o.useCallback)((function(n){return Object(l.a)(1e3*n).tz(e).format(t)}),[t,e])}},3:function(e,t){},"6ukn":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("MwQV");function r(e){return new Promise((function(t){a.a.call("get","/methods/tags/search-company-tags",{q:e}).data((function(e){t(e.map((function(e){return{label:e.name,value:e.id}})))}))}))}},"A+wq":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return mn}));var a=n("q1tI"),r=n.n(a),i=n("Ty5D"),l=n("TtP3"),o=n("9Koi"),c=n("17x9"),s=n.n(c),u=n("rpa7"),m=n("/MKj"),f=n("7yic"),d=n("MwQV"),p=function(e){return{type:f.a.CLIENTS_LOADING_ERROR,payload:e}},v=function(){return function(e,t){e({type:f.a.CLIENTS_LOADING});var n=t().liveChat.get("clientsIds").size;return d.a.call("get","/methods/live-chat/clients-list",{offset:n}).data((function(t){e(function(e){return{type:f.a.CLIENTS_LOADED,payload:e}}(t))})).catch((function(t,n){e(p(n))}))}},b=function(){return function(e){d.a.call("get","/methods/live-chat/clients--waiting-live-chat-list").data((function(t){e(function(e){return{type:f.a.CLIENTS_ASKING_LIVECHAT_LOADED,payload:e}}(t))})).catch((function(t,n){e(p(n))}))}},g=function(e){return function(t,n){e?n().liveChat.getIn(["clientsMap",e.toString()])?t({type:f.a.SET_ACTIVE_CLIENT,payload:e}):d.a.call("get","/methods/live-chat/get-client/".concat(e)).data((function(e){t({type:f.a.SET_LOADED_ACTIVE_CLIENT,payload:e})})):t({type:f.a.SET_ACTIVE_CLIENT,payload:e})}},h=function(e){return function(t,n){var a=n().liveChat,r=a.getIn(["oldClientMessages",0,"id"]);if(a.get("oldMessagesHasMore")){t({type:f.a.CLIENT_MESSAGES_LOADING,payload:null});var i={};return r&&(i.lastId=r),d.a.call("get","/methods/live-chat/get-messages/".concat(e),i).data((function(e){var n;t((n=e,{type:f.a.CLIENT_MESSAGES_LOADED,payload:n}))}))}}},y=function(){return function(e,t){e({type:f.a.ONLINE_VISITOR_CLIENTS_LOADING});var n=t().liveChat.get("onlineVisitorClientsIds").size;return d.a.call("get","/methods/live-chat/online-visitors-list",{offset:n}).data((function(t){e(function(e){return{type:f.a.ONLINE_VISITOR_CLIENTS_LOADED,payload:e}}(t))})).catch((function(t,n){var a;e((a=n,{type:f.a.ONLINE_VISITOR_CLIENTS_LOADING_ERROR,payload:a}))}))}},E=n("05OR"),O=n("HlzF");function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function j(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(a.useState)(null),r=C(n,2),i=r[0],l=r[1];function o(){var n=new O.Howl({src:[e]});t&&n.loop();var a=n.play();l((function(){return function(){return n.stop(a)}}))}var c=function(){return setTimeout(o,1e3)};return[c,i]}var N=n("gQBd");function S(){return Object(m.e)((function(e){return e.liveChat.getIn(["clientsMap",e.liveChat.get("activeClientId")])}))}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function M(e){var t=e.setActiveClientChannel,n=e.openedChatId,i=e.children,l=e.updateClientsLastMessageDate,o=e.addClientAskingLivechat,c=e.handleVisitorGotOperator,s=e.openChatWithClient,f=e.updateClient,d=e.loadClients,p=e.needPreloadClients,v=e.addNewMessage,b=e.handleConversationStopped,g=e.handleClientDidNotGetOperator,h=e.clientSessionOpened,y=e.clientSessionClosed,O=Object(u.a)();Object(a.useEffect)((function(){n?p?d().then((function(){s(n)})):s(n):s(null)}),[n]),function(e){var t=Object(m.e)((function(e){var t=e.liveChat.get("clientsAskingLiveChatIds");return!!(t&&t.size>0)})),n=I(j("/audio/bring.mp3",!0),2),r=n[0],i=n[1],l=e.user_notifications_setting.site_long_notifications&&t;Object(a.useEffect)((function(){l?r():i&&i()}),[l]),Object(a.useEffect)((function(){return function(){i&&i()}}),[i])}(O);var C=I(j("/audio/notification.mp3"),1)[0],w=S(),T=null==w?void 0:w.id.toString(),M=function(){var e=[];return O.departments.forEach((function(t){e.push(N.a.private("Department.".concat(t.id)))})),e.push(N.a.private("Company.".concat(O.company_id,".Department"))),e};return Object(a.useEffect)((function(){M().forEach((function(e){e.listen("VisitorAskingForLivechat",(function(e){var t=e.client;o(t)})).listen("VisitorAskingForLivechat",(function(e){var t=e.client;o(t)})).listen("VisitorGotLivechatOperator",(function(e){var t=e.client;c(t,O.id)})).listen("ClientDataChanged",(function(e){var t=e.clientId,n=e.changedFieldName,a=e.changedFieldValue;f(t,n,a)})).listen("VisitorGotLivechatOperator",(function(e){var t=e.client;c(t,O.id)})).listen("StopConversationWithClient",(function(e){var t=e.clientId;b(t)})).listen("VisitorDidNotGetOperator",(function(e){var t=e.client;g(t)})).listen("ClientSessionOpened",(function(e){var t=e.client;h(t)})).listen("ClientSessionClosed",(function(e){var t=e.client,n=e.hasOtherSessions;y(t,n)}))}))}),[O]),Object(a.useEffect)((function(){var e=M();return e.forEach((function(e){e.listen("ClientNewMessage",(function(e){var t,n=e.message,a=e.client;n.client=a,l(n);var r=Boolean(n.user&&(null===(t=n.user)||void 0===t?void 0:t.id.toString())!==O.id.toString());(n.type===E.e||r)&&C()}))})),function(){e.forEach((function(e){e.stopListening("ClientNewMessage")}))}}),[O,T]),function(e){var t=S(),n=null==t?void 0:t.id.toString();Object(a.useEffect)((function(){if(n)return e(n)}),[n,e])}(Object(a.useCallback)((function(e){if(e){var n=N.a.private("Client.".concat(e));return n.listen("ClientNewMessage",(function(e){var t=e.message,n=e.client;t.client=n,v(t)})),t(n),function(){n.stopListening("ClientNewMessage"),t(null)}}}),[v,t])),r.a.createElement(r.a.Fragment,null,i)}M.propTypes={openedChatId:s.a.string,needPreloadClients:s.a.bool.isRequired,updateClientsLastMessageDate:s.a.func.isRequired,addClientAskingLivechat:s.a.func.isRequired,handleVisitorGotOperator:s.a.func.isRequired,openChatWithClient:s.a.func.isRequired,updateClient:s.a.func.isRequired,loadClients:s.a.func.isRequired,addNewMessage:s.a.func.isRequired,handleConversationStopped:s.a.func.isRequired,handleClientDidNotGetOperator:s.a.func.isRequired,clientSessionOpened:s.a.func.isRequired,clientSessionClosed:s.a.func.isRequired,setActiveClientChannel:s.a.func.isRequired,children:s.a.any.isRequired};var A=Object(m.c)((function(e){var t;return{needPreloadClients:!(null===(t=e.liveChat.get("clientsIds"))||void 0===t?void 0:t.size)}}),(function(e){return{openChatWithClient:function(t){return e(g(t))},updateClientsLastMessageDate:function(t){e(function(e){return{type:f.a.CLIENTS_UPDATE_LAST_MESSAGE,payload:e}}(t))},addClientAskingLivechat:function(t){e(function(e){return{type:f.a.CLIENTS_ADD_ASKING_LIVECHAT,payload:e}}(t))},handleVisitorGotOperator:function(t,n){e(function(e){return{type:f.a.CLIENTS_GOT_OPERATOR,payload:e}}({client:t,operatorId:n}))},handleClientDidNotGetOperator:function(t){e(function(e){return{type:f.a.CLIENTS_DID_NOT_GET_OPERATOR,payload:e}}(t))},handleConversationStopped:function(t){e(function(e){return{type:f.a.CONVERSATION_STOPPED,payload:e}}(t))},updateClient:function(t,n,a){e(function(e,t,n){return{type:f.a.UPDATE_CLIENT_DATA,payload:{clientId:e,fieldName:t,data:n}}}(t,n,a))},loadClients:function(t){return e(v())},addNewMessage:function(t){e(function(e){return{type:f.a.CLIENT_NEW_MESSAGE,payload:e}}(t))},clientSessionOpened:function(t){var n;e((n=t,{type:f.a.ONLINE_VISITOR_NEW_SESSION_OPENED,payload:n}))},clientSessionClosed:function(t,n){e(function(e,t){return{type:f.a.ONLINE_VISITOR_SESSION_CLOSED,payload:{client:e,hasMoreSessions:t}}}(t,n))}}}))(M),R=function(){var e=Object(o.a)().t;return r.a.createElement("div",{className:"w-100 text-large text-center align-self-center"},e("liveChat.chat-window.select-chat-placeholder"))},k=n("jNYE"),_=n("6Rhw"),x=n("sOKU"),q=n("TSYQ"),L=n.n(q);function D(e){var t=e.children,n=e.className;return r.a.createElement("div",{className:L()("sidebar-block",n)},t)}D.propTypes={children:s.a.any.isRequired,className:s.a.string};var V=D,F=n("ma3e");function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function G(e){var t=e.renderForm,n=e.renderView,i=z(Object(a.useState)(!1),2),l=i[0],o=i[1],c=function(){return o((function(e){return!e}))};return r.a.createElement(V,null,l?t(c):r.a.createElement("div",{className:"d-flex align-items-baseline justify-content-between"},n(),r.a.createElement(x.a,{onClick:c,color:"link",className:"no-shadow text-dec-none py-0 px-0"},r.a.createElement(F.m,{className:"icon-size-20 color-gray position-relative mb-1"}))))}G.propTypes={renderForm:s.a.func.isRequired,renderView:s.a.func.isRequired};var H=n("nc57"),W=n("x37D");function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e){var t=e.clientId,n=e.fieldName,a=e.fieldValue,i=e.renderField,l=e.renderView,c=Object(o.a)().t;return r.a.createElement(G,{renderView:l,renderForm:function(e){return r.a.createElement(H.a,{initialValues:U({},n,a),handleSubmit:function(a,r){(function(e,a){var r=a.setSubmitting,i=a.setErrors;return d.a.call("post","/methods/clients/".concat(t),{},U({},n,e[n])).validation((function(e,t){i(t),r(!1)})).catch((function(){r(!1)}))})(a,r).then(e)},renderForm:function(t){var n=t.handleChange,a=t.handleBlur,l=t.values,o=t.errors,s=t.isSubmitting;return r.a.createElement("div",null,i({handleChange:n,handleBlur:a,values:l,errors:o}),r.a.createElement(W.a,{className:"mr-3 mb-2",disabled:s},c("common.saveBtnText")),r.a.createElement(x.a,{className:"mb-2",onClick:e},c("common.cancelBtnText")))}})}})}B.propTypes={clientId:s.a.oneOfType([s.a.string,s.a.number]).isRequired,fieldName:s.a.string.isRequired,fieldValue:s.a.any,renderField:s.a.func.isRequired,renderView:s.a.func.isRequired};var K=r.a.memo(B);function $(e){var t=e.client,n=Object(o.a)().t,i=t.name,l=Object(a.useCallback)((function(){return r.a.createElement("div",null,i)}),[i]),c=Object(a.useCallback)((function(e){var t=e.handleChange,a=e.handleBlur,i=e.values,l=e.errors;return r.a.createElement(_.a,{className:"pt-0",id:"name",name:"name",title:r.a.createElement("span",null,"Client info"),label:n("liveChat.chat-window.details.name-label"),placeholder:n("liveChat.chat-window.details.name-placeholder"),type:"text",onChange:t,onBlur:a,value:i.name||"",errors:l})}),[n]);return r.a.createElement(K,{clientId:t.id,fieldName:"name",fieldValue:i||"",renderView:l,renderField:c})}$.propTypes={client:s.a.instanceOf(k.a).isRequired};var X=n("XRgj");function J(e){var t=e.name,n=e.value;return n?r.a.createElement("div",{className:"text-middle d-flex mt-1 mb-1"},r.a.createElement("span",{className:"mr-1"},t),r.a.createElement("span",null,"function"==typeof n?n():n)):null}J.propTypes={name:s.a.string.isRequired,value:s.a.any};var Q=n("mDHu"),Y=n("zEWu"),Z=n("T7vI");function ee(e){var t=e.service,n=e.variables,a=void 0===n?{}:n,i=Object(o.a)().t,l=null,c=[];switch(+t){case X.h:l=r.a.createElement(r.a.Fragment,null,r.a.createElement(J,{name:i("liveChat.chat-window.details.variable-ip"),value:a.ip}),Object(Y.a)(a.geo)?r.a.createElement(J,{name:i("liveChat.chat-window.details.variable-geo"),value:function(){return r.a.createElement(Q.a,{geo:a.geo})}}):null);break;case X.d:case X.g:case X.a:c=[],a.first_name&&c.push(a.first_name),a.last_name&&c.push(a.last_name),l=r.a.createElement(J,{name:i("liveChat.chat-window.details.variable-name"),value:c.join(" ")});break;case X.e:case X.f:case X.c:case X.b:l=r.a.createElement(J,{name:i("liveChat.chat-window.details.variable-phone"),value:a.phone_number})}return r.a.createElement(V,null,l&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"client-info-title color-black"},i("liveChat.chat-window.details.variables-title")),r.a.createElement(Z.a,{data:a})))}ee.propTypes={service:s.a.number.isRequired,variables:s.a.object.isRequired};var te=r.a.memo(ee),ne=n("xilt"),ae=n("6ukn");function re(e){var t=e.clientId,n=e.tags;n=n.map((function(e){return{label:e.name,value:e.id}}));var i=Object(o.a)().t,l=Object(a.useCallback)((function(e){var n=(e||[]).map((function(e){return{id:e.__isNew__?null:e.value,name:e.label}}));d.a.call("post","/methods/tags/add-client-tags/".concat(t),{},{tags:n})}),[t]);return r.a.createElement(V,null,r.a.createElement("p",{className:"mb-2"},i("liveChat.chat-window.details.tags-title")),r.a.createElement(ne.a,{value:n,isMulti:!0,defaultOptions:!0,loadOptions:ae.a,onChange:l}))}re.defaultValue={tags:s.a.array},re.propTypes={clientId:s.a.oneOfType([s.a.string,s.a.number]).isRequired,tags:s.a.array};var ie=r.a.memo(re),le=n("3OM0");function oe(e){var t=e.client,n=Object(o.a)().t,i=t.note,l=Object(a.useCallback)((function(e){var t=e.handleChange,a=e.handleBlur,i=e.values,l=e.errors;return r.a.createElement(_.a,{className:"pt-0",id:"note",name:"note",label:n("liveChat.chat-window.details.note-label"),placeholder:n("liveChat.chat-window.details.note-placeholder"),type:"textarea",onChange:t,onBlur:a,value:i.note||"",errors:l})}),[n]),c=Object(a.useCallback)((function(){return r.a.createElement("div",null,r.a.createElement(le.a,{className:"client-info-title color-black pr-1",htmlFor:"note"},n("liveChat.chat-window.details.note-title")),r.a.createElement("i",{className:"d-block"},i||n("liveChat.chat-window.details.note-empty-text")))}),[i,n]);return r.a.createElement(K,{clientId:t.id,fieldName:"note",fieldValue:i||"",renderView:c,renderField:l})}oe.propTypes={client:s.a.instanceOf(k.a).isRequired};var ce=r.a.memo(oe),se=n("FN/A"),ue=n("83d4"),me=n("fOp/"),fe=n("Mpt7");function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=ye(e);if(t){var r=ye(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return he(this,n)}}function he(e,t){return!t||"object"!==de(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(i,e);var t,n,a,r=ge(i);function i(){return pe(this,i),r.apply(this,arguments)}return t=i,a=[{key:"instantiate",value:function(e){return new i(e)}}],(n=null)&&ve(t.prototype,n),a&&ve(t,a),i}(Object(fe.c)({id:null,render:function(){return null}})),Oe=n("DCcX"),Ce=n("CaDr"),we=n("OBzv");function je(e){var t=e.text,n=e.onConfirm,a=e.onReject;return r.a.createElement(Oe.a,{isOpen:!0,toggle:a,className:"confirm-modal"},r.a.createElement(Ce.a,null,t),r.a.createElement(we.a,null,r.a.createElement(x.a,{color:"primary",onClick:n},"Confirm")," ",r.a.createElement(x.a,{color:"secondary",onClick:a},"Cancel")))}je.propTypes={text:s.a.string.isRequired,onConfirm:s.a.func.isRequired,onReject:s.a.func.isRequired};var Ne=je,Se=n("mNz5"),Ie=n.n(Se),Te=function(e){return{type:me.a.REMOVE,payload:e}},Me=function(e){return function(t){return new Promise((function(n,a){var i=Ie()(),l=new Ee({id:i,data:{text:e,onConfirm:n,onReject:a},render:function(){return r.a.createElement(Ne,{text:e,onConfirm:function(){n(),t(Te(i))},onReject:function(){a(),t(Te(i))}})}});t(function(e){return{type:me.a.ADD,payload:e}}(l))}))}};function Ae(e){var t=e.clientId,n=e.responsibleOperator,a=Object(u.a)(),i=Object(m.d)(),l=Object(o.a)().t;return n&&n.id===a.id?r.a.createElement(x.a,{className:"leave-chat-btn",color:"outline-danger",onClick:function(){i(Me("Do you really want leave conversation?")).then((function(){d.a.call("post","/methods/live-chat/stop-conversation/".concat(t))}))}},l("liveChat.chat-window.details.leave-chat-btn")):null}Ae.propTypes={clientId:s.a.oneOfType([s.a.string,s.a.number]).isRequired,responsibleOperator:s.a.instanceOf(ue.d)};var Re=Ae;function ke(e){var t=e.operator,n=e.clientId,a=Object(o.a)().t;return r.a.createElement(V,null,r.a.createElement("p",{className:"client-info-title color-black"},a("liveChat.chat-window.details.responsible-operator-title")),t?r.a.createElement("div",{className:"d-flex flex-wrap justify-content-between"},r.a.createElement("div",{className:"d-flex align-items-center mr-2 mb-2"},r.a.createElement(se.a,{user:t}),r.a.createElement("span",{className:"ml-2"},t.name)),r.a.createElement(Re,{clientId:n,responsibleOperator:t})):r.a.createElement("div",{className:"text-center"},a("liveChat.chat-window.details.no-responsible-operator")))}ke.propTypes={operator:s.a.instanceOf(ue.d),clientId:s.a.number.isRequired};var _e=r.a.memo(ke);function xe(e){var t=e.attachment,n=e.fullWidth;switch(t.type){case E.b:return r.a.createElement("div",{className:"py-2",style:{maxWidth:n?200:100}},r.a.createElement("img",{src:t.data.url,alt:"",className:"img-fluid"}));case E.c:return r.a.createElement("div",{className:"py-2",style:{maxWidth:n?300:150}},r.a.createElement("video",{controls:"controls",className:"chat-message-video"},r.a.createElement("source",{src:t.data.url})));case E.a:return r.a.createElement("div",{className:"chat-message-file my-1"},r.a.createElement("a",{href:t.data.url},r.a.createElement(F.r,{className:"icon-size-20 color-gray"})))}return null}xe.propTypes={attachment:s.a.object,fullWidth:s.a.bool};var qe=xe;function Le(e){switch(e.type){case E.f:return null;case E.d:return"/img/default_chatbot_img.svg";case E.e:return"/img/default_user_image.svg"}}function De(e){var t=e.chatMessage,n=e.isPreview,a=e.formatMsgTime,i=function(e){return e.isFromClient?e.client:e.isFromOperator?e.user:{name:"Bot"}}(t),l=Le(t);return r.a.createElement("div",{className:L()("message-container clearfix",{"from-client":t.isFromClient,"from-operator":t.isFromOperator,"from-bot":t.isFromBot,preview:n})},r.a.createElement("div",{className:"message-wrapper"},r.a.createElement("div",{className:"message py-1"},l?r.a.createElement("img",{className:"message-img-autor mx-sm-4 mx-2",src:l,alt:"author img"}):null,r.a.createElement("div",{className:"message-content text-block"},r.a.createElement("div",{className:"chat-message color-black",dangerouslySetInnerHTML:{__html:t.message}}),r.a.createElement("div",null,t.attachment?r.a.createElement(qe,{attachment:t.attachment,fullWidth:!t.message}):null),r.a.createElement("div",{className:"message-info-mark mt-2"},r.a.createElement("span",{className:"color-black mr-2"},null==i?void 0:i.name),t.created_at?r.a.createElement("span",{className:"color-dark-gray"},a(t.created_at)):null)))))}De.defaultProps={isPreview:!1},De.propTypes={chatMessage:s.a.instanceOf(E.g).isRequired,isPreview:s.a.bool,formatMsgTime:s.a.func.isRequired};var Ve=r.a.memo(De),Fe=n("RotF"),ze=n.n(Fe),Pe=n("wDsf");function Ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return He(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return He(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var We=n("YOdH"),Ue=n("19iC"),Be=n("gmZo");function Ke(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=Object(We.a)(),n=Object(Ue.b)(),r=Object(Ue.c)(),i=Object(o.a)(),l=i.t;return Object(a.useCallback)((function(a){var i=Object(Be.a)(1e3*a).tz(t);if(((new Date).getTime()-i.toDate().getTime())/1e3<3600&&e)return i.fromNow();if(i.isSame(new Date,"day"))return l("common.date.today")+", "+i.format(r);var o=new Date;return i.isSame(o.setTime(o.getTime()-864e5),"day")?l("common.date.yesterday")+", "+i.format(r):i.format(n)}),[n,t,r,l,e])}function $e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Je(e){var t,n,i,l=e.client,o=e.activeClientChannel,c=e.newMessages,s=e.oldMessages,u=e.loading,m=e.hasMore,f=e.loadMessages,d=null===(t=l.name)||void 0===t?void 0:t.toString(),p=l.id.toString(),v=Ke(),b=$e(Object(a.useState)(null),2),g=b[0],h=b[1],y=$e(function(e,t,n){var r=e.id.toString(),i=Object(Pe.a)(r),l=Object(a.useRef)(),o=Ge(Object(a.useState)(!1),2),c=o[0],s=o[1],u=Ge(Object(a.useState)(!1),2),m=u[0],f=u[1],d=Object(a.useCallback)((function(){var e=l.current;return e.clientHeight+e.scrollTop>=e.scrollHeight-50}),[l]),p=Object(a.useCallback)((function(){var e=l.current;e.scrollTop=e.scrollHeight}),[l]);Object(a.useEffect)((function(){!t&&r&&(s(!1),f(!1))}),[r,t]),Object(a.useEffect)((function(){!c&&t&&r&&(p(),s(!0),f(!0))}),[p,t,c,r]),Object(a.useEffect)((function(){r===i&&c&&m&&p()}),[n,c,r,i]);var v=Object(a.useCallback)((function(){var e=d();e!==m&&f(e)}),[m,f,d]);return[l,v,c,d]}(l,s,c),4),O=y[0],C=y[1],w=y[2],j=y[3];Object(a.useEffect)((function(){f(p)}),[p,f]);var N=Object(a.useCallback)((function(e,t){return e&&!t?E.g.instantiate({id:"preview",message:e,created_at:null,client:l,type:E.e}):null}),[d]);Object(a.useEffect)((function(){if(o)return o.listenForWhisper("typing",(function(e){var t=e.message,n=e.fromOperator;h(N(t,n)),setTimeout((function(){h(null)}),2e3)})),function(){o.stopListeningForWhisper("typing")}}),[o,N]);var S,I=null===(n=O.current)||void 0===n?void 0:n.scrollHeight,T=null===(i=O.current)||void 0===i?void 0:i.scrollTop;return Object(a.useEffect)((function(){var e=O.current;if(e&&I&&!j()){var t=e.scrollHeight-I;e.scrollTop=T+t}}),[s,g]),S=s?r.a.createElement("div",{className:"pr-4"},r.a.createElement(ze.a,{isReverse:!0,loadMore:function(){m&&!u&&w&&f(p)},hasMore:m&&!u&&w,loader:null,useWindow:!1,getScrollParent:function(){return O.current}},s.map((function(e,t){return r.a.createElement(Ve,{key:"".concat(t,"-").concat(e.id),chatMessage:e,formatMsgTime:v})}))),c.map((function(e){return r.a.createElement(Ve,{key:e.id,chatMessage:e,formatMsgTime:v})})),g?r.a.createElement(Ve,{chatMessage:g,formatMsgTime:v}):null):null,r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"small-scrollbar messages-list messages-list-scrollbar w-100 pr-2",ref:O,onScroll:C},S))}Je.propTypes={client:s.a.instanceOf(k.a).isRequired,activeClientChannel:s.a.object,newMessages:s.a.object.isRequired,oldMessages:s.a.object,loading:s.a.bool,hasMore:s.a.bool,loadMessages:s.a.func.isRequired};var Qe=Object(m.c)((function(e){var t=e.liveChat;return{newMessages:t.get("newClientMessages"),oldMessages:t.get("oldClientMessages"),hasMore:t.get("oldMessagesHasMore"),loading:t.get("clientMessagesLoading")}}),(function(e){return{loadMessages:function(t){return e(h(t))}}}))(Je),Ye=n("7BfX"),Ze=n("55Ip");function et(e){var t,n,a=e.variables;switch(+e.integrationType){case X.h:t=r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"mr-2"},a.ip),Object(Y.a)(a.geo)?r.a.createElement(Q.a,{geo:a.geo}):null);break;case X.d:case X.g:case X.a:n=[],a.first_name&&n.push(a.first_name),a.last_name&&n.push(a.last_name),t=r.a.createElement("div",null,n.join(" "));break;case X.e:case X.f:case X.c:case X.b:t=r.a.createElement("div",null,a.phone_number);break;default:t=null}return t?r.a.createElement("div",{className:"mb-2 d-flex flex-wrap"},t):null}et.propTypes={variables:s.a.object.isRequired,integrationType:s.a.number.isRequired};var tt=et,nt=n("HayB");function at(e){var t=e.onClick,n=e.href,a=r.a.createElement(F.d,{className:"icon-size-20 color-blue mb-2"});return t?r.a.createElement("button",{className:"btn btn-link no-shadow text-dec-none d-flex align-items-center px-2",onClick:t},a):n?r.a.createElement(Ze.a,{className:"btn btn-link no-shadow text-dec-none d-flex align-items-center px-2",to:n},a):null}function rt(e){var t=e.onClick,n=e.href,a=e.client,i=e.toggleShowDetails,l=a.integration.service,o=a.variables;return r.a.createElement("div",{className:"mobile-chat-header-container pt-3 pb-2 pl-1"},r.a.createElement(at,{onClick:t,href:n}),r.a.createElement("button",{type:"button",onClick:i,className:"current-interlocutor btn-link no-shadow border-0 w-100 px-1 d-flex align-items-center text-left"},r.a.createElement("div",{className:"d-flex flex-wrap align-items-center img-block mr-3 mb-2"},nt.b[l]()),r.a.createElement("div",{className:"d-flex flex-wrap align-items-center"},r.a.createElement("div",{className:"w-100 mb-2"},a.name),o&&r.a.createElement(tt,{variables:o,integrationType:l}))))}at.propTypes={onClick:s.a.func,href:s.a.string},rt.propTypes={onClick:s.a.func,href:s.a.string,client:s.a.instanceOf(k.a).isRequired,toggleShowDetails:s.a.func.isRequired};var it=rt;function lt(e){var t=e.file,n=e.removeFile;return r.a.createElement("div",{className:"d-flex align-items-center px-2"},r.a.createElement(F.r,{className:"icon-size-14 color-gray mr-1"}),r.a.createElement("span",null,t.name),r.a.createElement("button",{onClick:n,className:"btn btn-link text-dec-none no-shadow p-1"},r.a.createElement(F.R,{className:"icon-size-12 color-red"})))}lt.propTypes={file:s.a.shape({name:s.a.string.isRequired}),removeFile:s.a.func.isRequired};var ot=r.a.memo(lt);function ct(e){var t=e.message,n=e.handleMessageChange,a=e.handleKeyDown,i=Object(o.a)().t;return r.a.createElement("textarea",{className:"w-100 message-text-field ml-sm-4 ml-2",onChange:n,onKeyDown:a,value:t||"",placeholder:i("liveChat.chat-window.text-editor-placeholder")})}ct.propTypes={message:s.a.string,handleMessageChange:s.a.func.isRequired,handleKeyDown:s.a.func.isRequired};var st=ct;function ut(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ft(e,t){return d.a.call("post","/methods/live-chat/pick-client/".concat(e),{},{text:t})}function dt(e){var t=e.children,n=e.clientId,i=e.color,l=e.text,o=e.afterSend,c=e.title,s=e.className,m=ut(Object(a.useState)(!1),2),f=m[0],d=m[1],p=Object(u.a)();return r.a.createElement(x.a,{className:L()(s),disabled:f,color:i,onClick:function(){d(!0),ft(n,l||p.default_conversation_message).then((function(){o&&o()})).catch((function(){d(!1)}))},type:"button",title:c},t)}dt.defaultProps={color:"warning"},dt.propTypes={clientId:s.a.oneOfType([s.a.string,s.a.number]).isRequired,children:s.a.any.isRequired,color:s.a.string,text:s.a.string,title:s.a.string,afterSend:s.a.func,className:s.a.string};var pt=r.a.memo(dt),vt=r.a.forwardRef((function(e,t){var n=e.handleAddFile;return r.a.createElement("label",{className:"mb-0"},r.a.createElement("input",{ref:t,type:"file",onChange:n,className:"d-none"}),r.a.createElement(F.D,{className:"icon-size-20 color-gray position-relative ml-sm-4 ml-2 my-2"}))}));vt.propTypes={handleAddFile:s.a.func.isRequired};var bt=r.a.memo(vt);function gt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ht(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ht(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function yt(e){var t=e.client,n=e.activeClientChannel,i=Object(u.a)(),l=t.operator_id,o=t.id.toString(),c=!l||l!==i.id,s=c?i.default_conversation_message:"",m=gt(Object(a.useState)(!1),2),f=m[0],p=m[1],v=gt(Object(a.useState)(s),2),b=v[0],g=v[1],h=gt(Object(a.useState)(null),2),y=h[0],E=h[1],O=Object(a.useRef)(),C=Object(a.useCallback)((function(){if(!f){p(!0);var e=new FormData;e.append("text",b),e.append("attachment",y),d.a.call("post","/methods/live-chat/send-message/".concat(o),{},e).then((function(){M()})).finally((function(){p(!1)}))}}),[f,b,y,M,o]),w=Object(a.useCallback)((function(e){f||(n&&n.whisper("typing",{message:"operator typing message...",fromOperator:l}),g(e.target.value))}),[l,f,n]),j=Object(a.useCallback)((function(e){f||E(e.target.files[0])}),[f]),N=i.default_conversation_message,S=Object(a.useCallback)((function(){p(!0),ft(o,b||N).then((function(){g(""),p(!1)})).catch((function(){p(!1)}))}),[o,b,N]),I=Object(a.useCallback)((function(e){f||13!==e.keyCode||e.shiftKey||(c?S():C())}),[c,f,C,S]),T=Object(a.useCallback)((function(){f||E(null)}),[f]),M=Object(a.useCallback)((function(){g(""),E(null),O.current&&(O.current.files=null,O.current.value=null)}),[O,g]),A=Object(Pe.a)(l);return Object(a.useEffect)((function(){l!==A&&g(s)}),[l,A,c]),r.a.createElement("div",{className:"mt-3"},y?r.a.createElement(ot,{file:y,removeFile:T}):null,r.a.createElement("div",{className:L()("d-flex align-items-center message-send-block",{"need-pick-user":c})},c?null:r.a.createElement(bt,{ref:O,handleAddFile:j}),r.a.createElement(st,{handleKeyDown:I,handleMessageChange:w,message:b}),c?r.a.createElement(pt,{className:"send-btn btn-link no-shadow border-0",clientId:t.id,text:b,afterSend:function(){return g("")}},r.a.createElement("img",{className:"send-icon",src:"/img/send.svg",alt:"send"})):r.a.createElement(W.a,{className:"send-btn btn-link no-shadow border-0",disabled:f||!y&&!b,onClick:C},r.a.createElement("img",{className:"send-icon",src:"/img/send.svg",alt:"send"}))))}yt.propTypes={client:s.a.instanceOf(k.a).isRequired,activeClientChannel:s.a.object};var Et=yt,Ot=s.a.oneOf(["conversations","online-visitors"]),Ct=n("YOqN");function wt(){return(wt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function jt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Nt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function St(e){var t=e.activeClientChannel,n=e.tab,l=Object(o.a)().t,c=Object(m.d)(),s=jt(Object(a.useState)(!1),2),u=s[0],f=s[1],d=jt(Object(a.useState)(!1),2),p=d[0],v=d[1],b=S();Object(a.useEffect)((function(){b||v(!1)}),[b]);var h,y=function(){f(!1)},E=Object(a.useCallback)((function(){f((function(e){return!e}))}),[]),O=Object(Ye.useSwipeable)({onSwipedLeft:function(){f(!0)},onSwipedRight:function(){u?y():(v(!0),c(g(null)))}});return p?r.a.createElement(i.a,{to:Ct.a.homeRoute.getLink(n)}):(h=b?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"messages-area"},r.a.createElement(it,{client:b,href:Ct.a.homeRoute.getLink(n),toggleShowDetails:E}),r.a.createElement("div",{className:"messages-area-content pt-xl-4 pt-0"},r.a.createElement(Qe,{client:b,activeClientChannel:t}),r.a.createElement(Et,{client:b,activeClientChannel:t}))),r.a.createElement("div",{className:"client-info-area-wrapper"},r.a.createElement(it,{client:b,onClick:y,toggleShowDetails:E}),r.a.createElement("div",{className:"client-info-area small-scrollbar"},r.a.createElement("div",{className:"info-area top-area pt-xl-4 pt-2 pb-4 px-3 mb-3"},r.a.createElement("div",{className:"client-info color-black mb-3"},l("liveChat.chat-window.details.title")),r.a.createElement($,{client:b}),r.a.createElement(_e,{operator:b.responsibleOperator,clientId:b.id,responsibleOperator:b.responsibleOperator})),r.a.createElement("div",{className:"info-area bottom-area py-4 px-3 mb-3"},r.a.createElement(te,{key:b.id,service:b.integration.service,variables:b.variables}),r.a.createElement(ie,{clientId:b.id,tags:b.tags}),r.a.createElement(ce,{client:b}))))):r.a.createElement(R,null),r.a.createElement("div",wt({className:L()("chat-window",{active:!!b,"show-info":u})},O),h))}St.propTypes={activeClientChannel:s.a.object,tab:Ot};var It=St,Tt=(n("jWsU"),n("hAFs"));var Mt=function(){var e=Object(u.a)(),t=Object(m.d)(),n=e.user_notifications_setting.site_long_notifications;return Object(a.useEffect)((function(){N.a.private("User.self.".concat(e.id)).listen("UserNotificationSettingsChanged",(function(n){var a=n.data;t(Object(Tt.a)(e.set("user_notifications_setting",a)))}))}),[Tt.a,e]),r.a.createElement("button",{className:"btn btn-link volume-btn no-shadow px-2 text-dec-none position-relative",onClick:function(){d.a.call("patch","/methods/user/notifications-settings/".concat(e.user_notifications_setting.id),{},{site_long_notifications:+!n})}},n?r.a.createElement(F.X,{className:"color-gray icon-size-30"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(F.X,{className:"color-gray icon-size-30"}),r.a.createElement(F.Q,{className:"volume-turned-off color-gray icon-size-14 position-absolute"})))},At=n("sKTO"),Rt=n("h4JF"),kt=n("zwA0");function _t(e){var t=e.clientsMap,n=e.clientsIds,i=e.clientsAskingLiveChatIds,l=e.loading,o=e.hasMore,c=e.error,s=e.view,u=e.loadClients,m=e.loadClientsAskingLiveChat,f=e.formatMsgTime,d=s;Object(a.useEffect)((function(){i||m()}),[i]);return!i||!n.size&&l?r.a.createElement(Rt.a,null):c?r.a.createElement(kt.a,null):r.a.createElement(d,{clientsMap:t,clientsIds:n,clientsAskingLiveChatIds:i,loadMore:function(){!l&&o&&u()},hasMore:o&&!l,formatMsgTime:f})}_t.propTypes={clientsMap:s.a.object.isRequired,clientsIds:s.a.object.isRequired,clientsAskingLiveChatIds:s.a.object,loading:s.a.bool,error:s.a.object,view:s.a.func.isRequired,loadClients:s.a.func.isRequired,loadClientsAskingLiveChat:s.a.func.isRequired,formatMsgTime:s.a.func.isRequired,hasMore:s.a.bool};var xt=Object(m.c)((function(e){var t=e.liveChat;return{loading:t.get("clientsListLoading"),hasMore:t.get("conversationClientsHasMore"),error:t.get("clientsListLoadingError"),clientsMap:t.get("clientsMap"),clientsIds:t.get("clientsIds"),clientsAskingLiveChatIds:t.get("clientsAskingLiveChatIds")}}),(function(e){return{loadClients:function(t){return e(v())},loadClientsAskingLiveChat:function(t){return e(b())}}}))(_t);function qt(e){var t=e.lastMessage,n=Le(t);return r.a.createElement("div",{className:"d-flex last-message mb-2"},n?r.a.createElement("img",{className:"last-message-author mr-2",src:n,alt:"author img"}):null,t.message?r.a.createElement("div",{className:"message-body color-dark-gray",dangerouslySetInnerHTML:{__html:t.message}}):r.a.createElement(F.r,{className:"icon-size-20 color-gray"}))}function Lt(e){var t=e.tags;return r.a.createElement(r.a.Fragment,null,t.map((function(e){return r.a.createElement("div",{key:e.id,className:"tag-item mr-1 my-1"},e.name)})))}qt.propTypes={lastMessage:s.a.instanceOf(E.g).isRequired,clientName:s.a.string},Lt.propTypes={tags:s.a.array.isRequired};var Dt=Lt;function Vt(e){var t=e.department;return r.a.createElement("div",{className:"d-inline-block tag-item department mr-1 my-1"},t.name)}Vt.propTypes={department:s.a.object.isRequired};var Ft=Vt,zt=n("oI+J"),Pt=n("Z7gm"),Gt=n("X68C"),Ht=n("kvuc");function Wt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ut(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Bt(e){var t=e.session;return r.a.createElement("p",{className:"mb-2 text-middle"},t.url)}function Kt(e){var t=e.sessions,n=Wt(Object(a.useState)(!1),2),i=n[0],l=n[1],o=t[0],c=t.slice(1);return r.a.createElement("div",null,r.a.createElement(Bt,{key:"session-".concat(o.id),session:o}),c.length?r.a.createElement(zt.a,{className:"session-dropdown",isOpen:i,toggle:function(){return l((function(e){return!e}))}},r.a.createElement(Pt.a,{className:"session-btn text-middle py-1 px-2",color:"outline-secondary",caret:!0},"+",c.length),r.a.createElement(Gt.a,null,c.map((function(e){return r.a.createElement(Ht.a,{className:"session-dropdown-item",key:"session-".concat(e.id),toggle:!1},r.a.createElement(Bt,{session:e}))})))):null)}Bt.propTypes={session:s.a.shape({id:s.a.number.isRequired,url:s.a.string.isRequired}).isRequired},Kt.propTypes={sessions:s.a.array.isRequired};var $t=Kt;function Xt(e){var t=e.client,n=e.tab,a=e.showSessions,i=e.formatMsgTime,l=t.integration.service,o=t.lastMessage,c=t.name,s=t.id,u=t.tags,m=t.department,f=t.variables,d=t.active_sessions;return r.a.createElement(Ze.a,{to:Ct.a.chatRoute.getLink(n,s),className:"d-flex chat-list-item-content pb-1"},r.a.createElement("div",{className:"service-icon-block"},r.a.createElement("span",null,nt.b[l]())),r.a.createElement("div",{className:"chat-list-info"},r.a.createElement("div",{className:"d-flex justify-content-between align-items-center w-100 mb-2"},r.a.createElement("span",null,c),o?r.a.createElement("span",{className:"date color-dark-gray"},i(o.created_at)):null),f&&r.a.createElement(tt,{variables:f,integrationType:l}),o?r.a.createElement(qt,{lastMessage:o,clientName:c}):null,r.a.createElement("div",{className:"d-flex flex-wrap"},m?r.a.createElement(Ft,{department:m}):null,r.a.createElement(Dt,{tags:u})),a&&d.length?r.a.createElement($t,{sessions:d}):null))}Xt.propTypes={client:s.a.instanceOf(k.a).isRequired,tab:Ot,showSessions:s.a.bool,formatMsgTime:s.a.func.isRequired};var Jt=r.a.memo(Xt);function Qt(e){var t=e.client,n=e.waitingLiveChat,a=e.isActive,i=e.tab,l=e.showSessions,o=e.formatMsgTime;return r.a.createElement("li",{id:t.id,className:L()("chat-list-item pt-3 pb-2 px-3",{active:a,"waiting-for-live-chat":n})},r.a.createElement(Jt,{client:t,tab:i,showSessions:l,formatMsgTime:o}))}Qt.propTypes={client:s.a.instanceOf(k.a).isRequired,waitingLiveChat:s.a.bool,isActive:s.a.bool,tab:Ot,showSessions:s.a.bool,formatMsgTime:s.a.func.isRequired};var Yt=Object(m.c)((function(e,t){var n;return{isActive:(null===(n=e.liveChat.get("activeClientId"))||void 0===n?void 0:n.toString())===t.client.id.toString()}}))(Qt);function Zt(e){var t=e.clientsMap,n=e.clientsIds,i=e.clientsAskingLiveChatIds,l=e.loadMore,c=e.hasMore,s=e.formatMsgTime,u=Object(a.useRef)(),m=Object(o.a)().t;return r.a.createElement("div",{ref:u,className:"chat-list view small-scrollbar"},i.size?r.a.createElement("ul",{className:"list-unstyled mb-0"},i.map((function(e){var n=t.get(e);return r.a.createElement(Yt,{key:n.id,client:n,waitingLiveChat:!0,tab:At.a,formatMsgTime:s})}))):null,r.a.createElement(ze.a,{pageStart:0,loadMore:l,hasMore:c,loader:null,useWindow:!1,getScrollParent:function(){return u.current}},r.a.createElement("ul",{className:"list-unstyled"},n.map((function(e){var n=t.get(e);return r.a.createElement(Yt,{key:n.id,client:n,tab:At.a,formatMsgTime:s})})))),i.size||n.size?null:r.a.createElement("div",{className:"mt-4 text-center text-middle"},m("liveChat.chats-panel.no-conversations")))}function en(e){var t=e.tab,n=Object(o.a)().t;return r.a.createElement("div",{className:"nav-panel-wrapper chat-list-switcher"},r.a.createElement("div",{className:"nav-panel nav-tabs px-3 w-100 d-flex"},r.a.createElement("div",{className:"nav-panel-item nav-item"},r.a.createElement(Ze.a,{to:Ct.a.homeRoute.getLink(At.a),className:L()("nav-link w-100 py-2 px-sm-3 px-2",{active:t===At.a})},n("liveChat.chats-panel.tab-conversations"))),r.a.createElement("div",{className:"nav-panel-item nav-item"},r.a.createElement(Ze.a,{to:Ct.a.homeRoute.getLink(At.b),className:L()("nav-link w-100 py-2 px-sm-3 px-2",{active:t===At.b})},n("liveChat.chats-panel.tab-online-visitors")))))}Zt.propTypes={clientsMap:s.a.object.isRequired,clientsIds:s.a.object.isRequired,clientsAskingLiveChatIds:s.a.object.isRequired,loadMore:s.a.func.isRequired,formatMsgTime:s.a.func.isRequired,hasMore:s.a.bool},en.propTypes={tab:Ot};var tn=r.a.memo(en);function nn(e){var t=e.clientsMap,n=e.clientsIds,a=e.loading,i=e.hasMore,l=e.error,o=e.view,c=e.loadOnlineVisitors,s=e.formatMsgTime,u=o;return!n.size&&a?r.a.createElement(Rt.a,null):l?r.a.createElement(kt.a,null):r.a.createElement(u,{clientsMap:t,clientsIds:n,loadMore:function(){!a&&i&&c()},hasMore:i&&!a,formatMsgTime:s})}nn.propTypes={clientsMap:s.a.object.isRequired,clientsIds:s.a.object.isRequired,loading:s.a.bool,error:s.a.object,view:s.a.func.isRequired,loadOnlineVisitors:s.a.func.isRequired,formatMsgTime:s.a.func.isRequired,hasMore:s.a.bool};var an=Object(m.c)((function(e){return{loading:e.liveChat.get("onlineVisitorsListLoading"),hasMore:e.liveChat.get("hasMoreOnlineVisitors"),error:e.liveChat.get("onlineVisitorClientsListLoadingError"),clientsMap:e.liveChat.get("clientsMap"),clientsIds:e.liveChat.get("onlineVisitorClientsIds")}}),(function(e){return{loadOnlineVisitors:function(t){e(y())}}}))(nn);function rn(e){var t=e.clientsMap,n=e.clientsIds,i=e.loadMore,l=e.hasMore,c=e.formatMsgTime,s=Object(a.useRef)(),u=Object(o.a)().t;return r.a.createElement("div",{ref:s,className:"chat-list view small-scrollbar"},r.a.createElement(ze.a,{pageStart:0,loadMore:i,hasMore:l,loader:null,useWindow:!1,getScrollParent:function(){return s.current}},n.size?r.a.createElement("ul",{className:"list-unstyled mb-0"},n.map((function(e){var n=t.get(e);return r.a.createElement(Yt,{key:n.id,client:n,tab:At.b,showSessions:!0,formatMsgTime:c})}))):r.a.createElement("div",{className:"mt-4 text-center text-middle"},u("liveChat.chats-panel.no-online-visitors"))))}function ln(e){var t,n=e.tab,a=S(),i=Ke(!1);switch(n){case At.a:t=r.a.createElement(xt,{view:Zt,formatMsgTime:i});break;case At.b:t=r.a.createElement(an,{view:rn,formatMsgTime:i});break;default:t=null}return r.a.createElement("div",{className:L()("chat-list-container",{"d-md-block d-none":!!a})},r.a.createElement(tn,{tab:n}),t)}rn.propTypes={clientsMap:s.a.object.isRequired,clientsIds:s.a.object.isRequired,loadMore:s.a.func.isRequired,formatMsgTime:s.a.func.isRequired,hasMore:s.a.bool},ln.propTypes={tab:Ot};var on=r.a.memo(ln),cn=n("dbgk");function sn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return un(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return un(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function un(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function mn(){var e=Object(o.a)().t,t=Object(i.j)(),n=t.chatId,c=t.type||At.a,s=sn(Object(a.useState)(null),2),u=s[0],m=s[1];return r.a.createElement(l.a,null,r.a.createElement("div",{className:"livechat-container"},r.a.createElement(A,{openedChatId:n,setActiveClientChannel:m},r.a.createElement(r.a.Fragment,null,r.a.createElement(cn.a,null,r.a.createElement("span",null,e("liveChat.title")),r.a.createElement(Mt,null)),r.a.createElement("div",{className:"live-chat-content-container pt-2"},r.a.createElement(on,{tab:c}),r.a.createElement(It,{tab:c,activeClientChannel:u}))))))}},T7vI:function(e,t,n){"use strict";var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i),o=n("9Koi"),c=n("zEWu"),s=n("mDHu");function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var d=["ip","geo","first_name","last_name","phone_number","email"];function p(e){var t=e.data,n=Object(o.a)().t,i=m(Object(a.useState)(!1),2),l=i[0],f=i[1],p=[],v=[];for(var b in t)if(t.hasOwnProperty(b)&&null!==t[b]){var g={name:b,value:t[b]};d.includes(b)?p.push(g):v.push(g)}var h=function(e){return Object(c.a)(e)?r.a.createElement(s.a,{geo:e}):Array.isArray(e)?e.join(", "):"object"===u(e)?JSON.stringify(e):e};return r.a.createElement("div",{className:"variable-items"},p.map((function(e){return h(e.value)?r.a.createElement("div",{className:"variable-item",key:e.name},r.a.createElement("span",{className:"item-name font-weight-bold"},e.name," "),r.a.createElement("span",{className:"item-value"},h(e.value))):null})),v.length&&!l?r.a.createElement("button",{type:"button",className:"btn btn-link no-shadow p-0 color-blue text-middle text-dec-none",onClick:function(){return f(!0)}},n("tables.json-show-more",{count:v.length})):null,v.length&&l?v.map((function(e){return h(e.value)?r.a.createElement("div",{className:"variable-item",key:e.name},r.a.createElement("span",{className:"item-name font-weight-bold"},e.name," "),r.a.createElement("span",{className:"item-value"},h(e.value))):null})):null)}p.propTypes={data:l.a.object.isRequired},t.a=p},gQBd:function(e,t,n){"use strict";var a=n("Vjiq");window.io=n("gFX4");var r=new a.a({broadcaster:"socket.io",host:window.location.origin});t.a=r},gmZo:function(e,t,n){"use strict";n("iYuL");var a=n("f0Wu");a.locale(window.locale),t.a=a},mDHu:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i);function o(e){var t=e.geo,n=[];return t.city&&n.push(t.city),t.country&&n.push(t.country),r.a.createElement("div",{className:"d-flex align-items-center"},t.iso?r.a.createElement("img",{className:"flag mr-2",src:"/img/flags/".concat(t.iso.toLowerCase(),".gif"),alt:t.iso}):null,r.a.createElement("div",{className:"location"},n.join(", ")))}o.propTypes={geo:l.a.object.isRequired}},wDsf:function(e,t,n){"use strict";var a=n("q1tI");t.a=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current=e})),t.current}},zEWu:function(e,t,n){"use strict";function a(e){return(null==e?void 0:e.iso)||(null==e?void 0:e.city)||(null==e?void 0:e.country)}n.d(t,"a",(function(){return a}))},zwA0:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("q1tI"),r=n.n(a),i=n("9Koi");function l(){var e=Object(i.a)().t;return r.a.createElement("div",null,e("common.site-error-message"))}}}]);