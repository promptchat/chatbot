(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{"/r69":function(e,a,t){"use strict";var n=t("q1tI"),r=t.n(n),l=t("17x9"),i=t.n(l),o=t("sPdi"),s=t("jrRI"),c=t("3OM0"),u=t("TSYQ"),m=t.n(u),d=t("ma3e"),p=t("yzbm"),b=t("9Koi");function v(){return(v=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function f(e){var a,t,n=e.id,l=e.label,i=e.errors,u=e.name,f=e.className,h=e.value,g=e.setFieldValue,y=e.onRemove,O=e.disabled,E=e.types,j=void 0===E?[]:E,w=m()({"is-invalid":Boolean(i&&(null===(a=i[u])||void 0===a?void 0:a.length))}),R=Object(b.a)().t;return r.a.createElement(s.a,{className:m()(f)},r.a.createElement(c.a,{htmlFor:n,className:m()(w)},"function"==typeof l?l():l),r.a.createElement(p.a,{onDrop:function(e){g(u,e[0])},disabled:O,accept:j.length?j:null},(function(e){var a=e.getRootProps,t=e.getInputProps;return r.a.createElement("section",{className:m()("dropzone-class")},r.a.createElement("div",v({},a(),{className:"load-img d-flex justify-content-center flex-column align-items-center p-3"}),r.a.createElement("input",v({},t(),{multiple:!1})),r.a.createElement(d.d,{className:"icon-size-40 color-gray"}),r.a.createElement("div",{className:"load-img-tip mt-3 text-center"},R("common.drag-and-drop"))))})),h?r.a.createElement("div",{className:m()("position-relative file-preview mr-4",w)},h.name,r.a.createElement("button",{type:"button",className:"btn btn-link no-shadow position-absolute file-preview-close-btn py-0 px-1",onClick:function(){g(u,null),y&&y()}},r.a.createElement(d.vb,{className:"color-red position-relative"}))):null,i&&(null===(t=i[u])||void 0===t?void 0:t.length)?r.a.createElement(o.a,{errors:i[u]}):null)}f.propTypes={errors:i.a.object,id:i.a.oneOfType([i.a.string,i.a.number]),label:i.a.any,name:i.a.string.isRequired,className:i.a.string,value:i.a.object,setFieldValue:i.a.func.isRequired,onRemove:i.a.func,types:i.a.array,disabled:i.a.bool},a.a=r.a.memo(f)},"1QrW":function(e,a,t){"use strict";var n=t("q1tI"),r=t.n(n),l=t("17x9"),i=t.n(l),o=t("sPdi"),s=t("jrRI"),c=t("3OM0"),u=t("L3zb"),m=t("TSYQ"),d=t.n(m);function p(){return(p=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function b(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}function v(e){var a,t,n=e.id,l=e.label,i=e.errors,m=e.name,v=e.onChange,f=e.className,h=e.phone,g=void 0!==h&&h,y=b(e,["id","label","errors","name","onChange","className","phone"]);return r.a.createElement(s.a,{className:d()(f)},r.a.createElement(c.a,{htmlFor:n},l),r.a.createElement(u.a,p({id:n,name:m,type:"text",onChange:function(e){g&&e.target.value&&"+"!==e.target.value[0]&&(e.target.value="+"+e.target.value);var a=e.target.value;(g?/^\+[0-9]*$/:/^[0-9]*$/).test(a)&&v(e)}},y,{invalid:!!(null===(a=i[m])||void 0===a?void 0:a.length)})),(null===(t=i[m])||void 0===t?void 0:t.length)?r.a.createElement(o.a,{errors:i[m]}):null)}v.propTypes={onChange:i.a.func.isRequired,errors:i.a.object.isRequired,id:i.a.oneOfType([i.a.string,i.a.number]),label:i.a.any.isRequired,name:i.a.string.isRequired,className:i.a.string,phone:i.a.bool},a.a=r.a.memo(v)},3:function(e,a){},"3zHg":function(e,a,t){"use strict";t.d(a,"a",(function(){return r}));var n=t("MwQV");function r(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(a){return new Promise((function(t){var r=e.findIndex((function(e){return e.value===a}));-1!==r?t(e[r]):n.a.call("get","/methods/departments/".concat(a)).data((function(e){t({label:e.name,value:e.id})}))}))}}()(e)}},"42tS":function(e,a,t){"use strict";t.r(a);var n=t("q1tI"),r=t.n(n),l=t("9Koi"),i=t("dbgk"),o=t("TtP3"),s=t("MwQV"),c=t("h4JF"),u=t("rpa7"),m=t("gQBd"),d=t("17x9"),p=t.n(d),b=t("55Ip"),v=t("BLzl"),f=t("/kxI");function h(e){var a=e.result,t=Object(l.a)().t;return r.a.createElement(v.a,{className:"clients-import mb-4 shadow"},r.a.createElement(f.a,{className:"rounded px-4 clients-import-result"},r.a.createElement("div",{className:""},r.a.createElement("div",{className:"title pb-2",dangerouslySetInnerHTML:{__html:t("clients.import-csv.total-rows-count",{count:'<span class="value">'.concat(a.total_rows_count,"</span>")})}}),r.a.createElement("div",{className:"title pb-2",dangerouslySetInnerHTML:{__html:t("clients.import-csv.imported-clients-count",{count:'<span class="value">'.concat(a.imported_clients_count,"</span>")})}}),r.a.createElement("div",{className:"title pb-2",dangerouslySetInnerHTML:{__html:t("clients.import-csv.import-status",{importStatus:'<span class="value">'+t("clients.import-csv.statuses.".concat(a.status))+"</span>"})}}),r.a.createElement("div",{className:"my-4"},r.a.createElement(b.a,{to:"/clients/1",className:"btn btn-success"},t("clients.import-csv.back-to-clients-btn"))))))}h.propTypes={result:p.a.shape({total_rows_count:p.a.number.isRequired,imported_clients_count:p.a.number.isRequired,status:p.a.number.isRequired}).isRequired};var g=h,y=t("Mpt7"),O=t("Buep"),E=t("nh1N"),j=t("/r69"),w=t("6Rhw"),R=t("1QrW"),N=t("ma3e");function C(e){var a=e.item,t=e.onItemChange,n=e.onRemove,i=e.errors,o=e.index,s=Object(l.a)().t;return r.a.createElement("div",{className:"d-flex flex-sm-nowrap flex-wrap align-items-end"},r.a.createElement(w.a,{className:"mr-sm-3 mr-2",id:"variables.".concat(o,".name"),name:"variables.".concat(o,".name"),label:s("clients.import-csv.variable-name-label"),placeholder:s("clients.import-csv.variable-name-placeholder"),value:a.get("name"),onChange:function(e){t(a.set("name",e.target.value))},errors:i}),r.a.createElement(R.a,{className:"mr-sm-3 mr-2",id:"variables.".concat(o,".position"),name:"variables.".concat(o,".position"),label:s("clients.import-csv.variable-position-label"),placeholder:s("clients.import-csv.variable-position-placeholder"),value:a.get("position"),onChange:function(e){t(a.set("position",e.target.value))},errors:i}),r.a.createElement("button",{className:"btn btn-link no-shadow p-sm-2 py-2 px-1 mb-3",type:"button",onClick:n},r.a.createElement(N.xb,{className:"color-gray icon-size-20"})))}C.propTypes={item:p.a.shape({name:p.a.string,position:p.a.string,get:p.a.func.isRequired,set:p.a.func.isRequired}),onItemChange:p.a.func.isRequired,onRemove:p.a.func.isRequired,errors:p.a.object,index:p.a.number};var _=C,q=t("sOKU"),P=t("x37D"),S=t("6jMY"),V=t("XRgj"),x=t("ok1R"),I=t("rhny"),F=t("6ukn"),T=t("R5y6"),k=t("jrRI"),M=t("3OM0"),D=t("TSYQ"),Q=t.n(D),A=t("sPdi"),B=t("apNI");function z(e){var a,t=e.id,n=e.label,l=e.errors,i=e.name,o=e.setFieldValue,s=e.value,c=e.className,u=e.placeholder;return r.a.createElement(k.a,{className:Q()(c)},r.a.createElement(M.a,{htmlFor:t},n),r.a.createElement(B.a,{searchable:!0,searchPlaceholder:" ",selected:s,placeholder:u,onSelect:function(e){o(i,e)}}),(null===(a=l[i])||void 0===a?void 0:a.length)?r.a.createElement(A.a,{errors:l[i]}):null)}z.defaultProps={isClearable:!0},z.propTypes={errors:p.a.object.isRequired,id:p.a.oneOfType([p.a.string,p.a.number]),value:p.a.oneOfType([p.a.string,p.a.number]),label:p.a.any.isRequired,name:p.a.string.isRequired,setFieldValue:p.a.func.isRequired,className:p.a.string,placeholder:p.a.string,isClearable:p.a.bool};var L=t("LdVD"),Y=t("3zHg"),H=Object(S.b)([V.c,V.d]);function J(e){var a=e.handleIntegrationChange,t=e.handleChangeCsv,n=e.handleClickAddVariable,i=e.handleVariableChange,o=e.handleClickRemoveVariable,s=e.handleChange,c=e.handleBlur,u=e.values,m=e.errors,d=e.isSubmitting,p=e.setFieldValue,b=Object(l.a)().t;return r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{className:"limiter",label:b("clients.import-csv.integration-label"),name:"integration_id",value:u.integration_id,setFieldValue:a,loadOptions:H,loadValue:E.a,errors:m,isClearable:!0}),r.a.createElement(O.a,{className:"limiter",label:b("clients.import-csv.department-label"),placeholder:b("departments.lobby-department"),name:"department_id",value:u.department_id,setFieldValue:p,loadOptions:L.a,loadValue:Y.a,errors:m,isClearable:!0}),u.integration_id?r.a.createElement(j.a,{name:"csv",label:b("clients.import-csv.file-label"),value:u.csv,setFieldValue:t,errors:m,types:[".csv"]}):null,u.csv?r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,null,r.a.createElement(I.a,null,r.a.createElement(R.a,{className:"limiter",id:"phone_number_position",name:"phone_number_position",label:b("clients.import-csv.phone-position-label"),placeholder:b("clients.import-csv.phone-position-placeholder"),value:u.phone_number_position,onChange:s,onBlur:c,errors:m}),r.a.createElement("div",{className:"limiter"},u.variables.map((function(e,a){return r.a.createElement(_,{key:a,index:a,item:e,onItemChange:function(e){i(a,e)},onRemove:function(){return o(a)},errors:m})})))),r.a.createElement(I.a,null,r.a.createElement(T.a,{className:"limiter",name:"tags",label:b("clients.import-csv.tags-label"),value:u.tags,setFieldValue:p,errors:m,loadOptions:F.a,isMulti:!0,isClearable:!0}),r.a.createElement(z,{className:"limiter",label:b("clients.import-csv.default_country"),placeholder:b("clients.import-csv.default_country"),value:u.country_code,name:"country_code",setFieldValue:p,errors:m}))),r.a.createElement("div",null,r.a.createElement(q.a,{className:"mb-3",type:"button",onClick:n},b("clients.import-csv.add-variable-btn")))):null,r.a.createElement(P.a,{className:"pt-2 px-4 mt-3 mb-sm-4 mb-5",disabled:d},b("common.saveBtnText")))}J.propTypes={handleIntegrationChange:p.a.func.isRequired,handleChangeCsv:p.a.func.isRequired,handleClickAddVariable:p.a.func.isRequired,handleVariableChange:p.a.func.isRequired,handleClickRemoveVariable:p.a.func.isRequired,handleChange:p.a.func.isRequired,setFieldValue:p.a.func.isRequired,handleBlur:p.a.func.isRequired,values:p.a.object.isRequired,errors:p.a.object.isRequired,isSubmitting:p.a.bool};var K=J,U=t("nc57");function $(){return($=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function W(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function X(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function G(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}function Z(e){var a=e.handleSubmit;return r.a.createElement(v.a,{className:"clients-import mb-4 shadow"},r.a.createElement(f.a,{className:"rounded px-4"},r.a.createElement(U.a,{initialValues:{integration_id:null,department_id:null,csv:null,tags:[],country_code:null,phone_number_position:"",variables:Object(y.a)([])},handleSubmit:a,renderForm:function(e){var a=e.values,t=e.setFieldValue,n=e.errors,l=e.setErrors,i=G(e,["values","setFieldValue","errors","setErrors"]);return r.a.createElement(K,$({},i,{values:a,setErrors:l,errors:n,handleIntegrationChange:function(e,a){t(e,a),a?s.a.call("get","/methods/clients/generate-import-name/".concat(a)).data((function(e){var a=e.name,n=e.code;t("country_code",n),t("tags",[{label:a,value:a}])})):(t("csv",null),t("phone_number_position",""),t("variables",Object(y.a)([])),t("tags",[]))},setFieldValue:t,handleChangeCsv:function(e,a){t(e,a),a||(t("phone_number_position",""),t("variables",Object(y.a)([])))},handleClickAddVariable:function(){t("variables",a.variables.push(Object(y.b)({name:"",position:""})))},handleVariableChange:function(e,n){t("variables",a.variables.set(e,n))},handleClickRemoveVariable:function(e){var r=function(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?W(Object(t),!0).forEach((function(a){X(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):W(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}({},n);r.variables&&delete r.variables,l(r),t("variables",a.variables.delete(e))}}))}})))}Z.propTypes={handleSubmit:p.a.func.isRequired};var ee=Z;function ae(e,a){return function(e){if(Array.isArray(e))return e}(e)||function(e,a){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],n=!0,r=!1,l=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done)&&(t.push(i.value),!a||t.length!==a);n=!0);}catch(e){r=!0,l=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw l}}return t}(e,a)||function(e,a){if(!e)return;if("string"==typeof e)return te(e,a);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return te(e,a)}(e,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,n=new Array(a);t<a;t++)n[t]=e[t];return n}a.default=function(){var e=Object(l.a)().t,a=ae(Object(n.useState)(null),2),t=a[0],d=a[1],p=ae(Object(n.useState)(null),2),b=p[0],v=p[1],f=Object(u.a)().id;Object(n.useEffect)((function(){m.a.private("App.Models.User.".concat(f)).listen("ClientsImportedFromCsv",(function(e){v(e)}))}),[f]);var h=t&&b&&(null==t?void 0:t.id)===(null==b?void 0:b.id);return r.a.createElement(o.a,null,r.a.createElement(i.a,null,e("clients.import-csv.title")),t?null:r.a.createElement(ee,{handleSubmit:function(e,a){var t=a.setSubmitting,n=a.setErrors,r=e.variables.toJS(),l=new FormData;for(var i in l.set("integration_id",e.integration_id),l.set("department_id",e.department_id||""),l.set("csv",e.csv),l.set("phone_number_position",e.phone_number_position),l.set("country_code",e.country_code),e.tags)e.tags.hasOwnProperty(i)&&l.set("tags[".concat(i,"]"),e.tags[i].label);for(var o in r)l.set("variables[".concat(o,"][name]"),r[o].name),l.set("variables[".concat(o,"][position]"),r[o].position);s.a.call("post","/methods/clients/import-csv",{},l).data((function(e){d(e)})).validation((function(e,a){n(a),t(!1)})).catch((function(){t(!1)}))}}),t&&!h?r.a.createElement(c.a,null):null,h?r.a.createElement(g,{result:b}):null)}},"6jMY":function(e,a,t){"use strict";t.d(a,"b",(function(){return r}));var n=t("MwQV");function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(a){return new Promise((function(t){var r={q:a};if(e&&Array.isArray(e)&&e.length)for(var l in e)r["type[".concat(l,"]")]=e[l];else e&&(r.type=e);n.a.call("get","/methods/integrations/search",r).data((function(e){t(e.map((function(e){return{label:e.name,value:e.id,integration:e}})))}))}))}}var l=r();a.a=l},"6ukn":function(e,a,t){"use strict";t.d(a,"a",(function(){return r}));var n=t("MwQV");function r(e){return new Promise((function(a){n.a.call("get","/methods/tags/search-company-tags",{q:e}).data((function(e){a(e.map((function(e){return{label:e.name,value:e.id}})))}))}))}},R5y6:function(e,a,t){"use strict";t.d(a,"a",(function(){return y}));var n=t("q1tI"),r=t.n(n),l=t("QDav"),i=t("xilt"),o=t("jrRI"),s=t("3OM0"),c=t("TSYQ"),u=t.n(c),m=t("sPdi"),d=t("17x9"),p=t.n(d),b=t("9Koi");function v(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function f(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?v(Object(t),!0).forEach((function(a){h(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function h(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var g={control:function(e){return f(f({},e),{},{"&, &:hover, &:focus":{borderColor:"#ced4da",boxShadow:"none"}})},menu:function(e){return f(f({},e),{},{zIndex:10})}};function y(e){var a,t,n=e.id,c=e.label,d=e.errors,p=e.loadOptions,v=e.name,f=e.setFieldValue,h=e.handleBlur,y=e.value,O=e.className,E=e.labelClass,j=e.placeholder,w=e.isClearable,R=e.cacheOptions,N=e.isMulti,C=e.isDisabled,_=e.defaultOptions,q=Object(b.a)().t,P=w?i.a:l.a;return r.a.createElement(o.a,{className:u()(O)},r.a.createElement(s.a,{className:u()(E),htmlFor:n},c),r.a.createElement(P,{cacheOptions:R,defaultOptions:_,loadOptions:p,onChange:function(e){f(v,e)},value:y,isClearable:w,className:u()({"is-invalid":!!(null===(a=d[v])||void 0===a?void 0:a.length)}),placeholder:j||q("common.default-select-placeholder"),styles:g,isMulti:N,isDisabled:C,onBlur:h}),(null===(t=d[v])||void 0===t?void 0:t.length)?r.a.createElement(m.a,{errors:d[v]}):null)}y.defaultProps={isClearable:!0,cacheOptions:!0,defaultOptions:!0},y.propTypes={errors:p.a.object.isRequired,id:p.a.oneOfType([p.a.string,p.a.number]),value:p.a.oneOfType([p.a.shape({label:p.a.string,value:p.a.oneOfType([p.a.string,p.a.number])}),p.a.array]),label:p.a.any.isRequired,name:p.a.string.isRequired,handleBlur:p.a.func,setFieldValue:p.a.func.isRequired,loadOptions:p.a.func.isRequired,className:p.a.string,labelClass:p.a.string,placeholder:p.a.string,isClearable:p.a.bool,isMulti:p.a.bool,isDisabled:p.a.bool,cacheOptions:p.a.bool,defaultOptions:p.a.oneOfType([p.a.bool,p.a.array])}},dbgk:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var n=t("q1tI"),r=t.n(n),l=t("17x9"),i=t.n(l);function o(e){var a=e.children;return r.a.createElement("h1",{className:"title-main mb-3"},a)}o.propTypes={children:i.a.any.isRequired}},gQBd:function(e,a,t){"use strict";var n=t("Vjiq");window.io=t("gFX4");var r=new n.a({broadcaster:"socket.io",host:window.location.origin});a.a=r},nh1N:function(e,a,t){"use strict";t.d(a,"a",(function(){return r}));var n=t("MwQV");function r(e){return new Promise((function(a){n.a.call("get","/methods/integrations/".concat(e)).data((function(e){a({label:e.name,value:e.id,service:e.service})}))}))}}}]);