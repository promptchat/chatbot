(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{"5+3T":function(e,t,n){"use strict";n.r(t);var a=n("q1tI"),r=n.n(a),i=n("dbgk"),l=n("TtP3"),o=n("MwQV"),u=n("Ty5D"),s=n("9Koi"),c=n("BLzl"),f=n("/kxI"),m=n("9Uk/"),d=n("Bg/h"),b=n("XgT/"),p=n("h4JF"),v=n("R5y6"),g=n("5f+b");function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}t.default=function(){var e=Object(s.a)().t,t=h(Object(m.a)(),2)[1],n=t.get("filters"),y=t.get("selected"),O=JSON.parse(n)||[],j=JSON.parse(y)||{},S=h(Object(a.useState)(null),2),E=S[0],w=S[1],C=h(Object(a.useState)(null),2),q=C[0],I=C[1],T=h(Object(a.useState)(null),2),R=T[0],A=T[1];Object(a.useEffect)((function(){o.a.call("get","/methods/campaigns/clients-from-filters",{filter:n,selected:y}).data((function(e){I(e)}))}),[n,y]),Object(a.useEffect)((function(){E&&o.a.call("get","/methods/campaigns/".concat(E)).catch((function(){w(null)}))}),[E]);var N,V=Object(a.useCallback)((function(e){return o.a.call("post","/methods/campaigns/".concat(E,"/subscribe"),{},e)}),[E]),F=Object(a.useCallback)((function(){A("/campaigns/1")}),[]);if(null!==R)return r.a.createElement(u.a,{to:R});if(E&&q){var x=Object(d.b)(q.clients);N=r.a.createElement(b.a,{afterSave:F,handleSubmit:V,fromFilters:!0,initialData:{filters:O,selected:j,clients:x,tags:[],integration:null}})}else N=E?r.a.createElement(p.a,null):r.a.createElement("div",null,r.a.createElement(v.a,{className:"limiter",id:"sendViaIntegration",name:"sendViaIntegration",label:e("campaigns.form.campaign-label"),value:E,setFieldValue:function(e,t){w(null==t?void 0:t.value)},loadOptions:g.a,errors:{}}));return r.a.createElement(l.a,null,r.a.createElement(i.a,null,e("campaigns.subscribe.title")),r.a.createElement(c.a,{className:"campaigns-view mb-4 shadow"},r.a.createElement(f.a,{className:"px-4 rounded"},N)))}},"6jMY":function(e,t,n){"use strict";n.d(t,"b",(function(){return r}));var a=n("MwQV");function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(t){return new Promise((function(n){var r={q:t};if(e&&Array.isArray(e)&&e.length)for(var i in e)r["type[".concat(i,"]")]=e[i];else e&&(r.type=e);a.a.call("get","/methods/integrations/search",r).data((function(e){n(e.map((function(e){return{label:e.name,value:e.id,integration:e}})))}))}))}}var i=r();t.a=i},"6ukn":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("MwQV");function r(e){return new Promise((function(t){a.a.call("get","/methods/tags/search-company-tags",{q:e}).data((function(e){t(e.map((function(e){return{label:e.name,value:e.id}})))}))}))}},"9Uk/":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("Ty5D");function r(){var e=Object(a.i)().search;return[e,new URLSearchParams(e)]}},"Bg/h":function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i),o=n("R5y6"),u=n("9Koi");function s(e){var t=e,n=[];return t.variables&&t.variables.phone_number&&n.push(t.variables.phone_number),t.variables&&t.variables.first_name&&n.push(t.variables.first_name),t.variables&&t.variables.last_name&&n.push(t.variables.last_name),{label:n.join(" ")||t.name,value:t.id}}var c=function(e){return e.map(s)};function f(e){var t=e.values,n=e.errors,a=e.setFieldValue,i=e.className,l=Object(u.a)().t;return r.a.createElement(o.a,{className:i,name:"clients",label:l("instantMessages.form.to-label"),value:t.clients,setFieldValue:a,errors:n,loadOptions:function(){return[]},defaultOptions:[],isMulti:!0})}f.propTypes={values:l.a.object.isRequired,errors:l.a.object.isRequired,setFieldValue:l.a.func.isRequired,className:l.a.string},t.a=f},R5y6:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n("q1tI"),r=n.n(a),i=n("QDav"),l=n("xilt"),o=n("jrRI"),u=n("3OM0"),s=n("TSYQ"),c=n.n(s),f=n("sPdi"),m=n("17x9"),d=n.n(m),b=n("9Koi");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h={control:function(e){return v(v({},e),{},{"&, &:hover, &:focus":{borderColor:"#ced4da",boxShadow:"none"}})},menu:function(e){return v(v({},e),{},{zIndex:10})}};function y(e){var t,n,a=e.id,s=e.label,m=e.errors,d=e.loadOptions,p=e.name,v=e.setFieldValue,g=e.handleBlur,y=e.value,O=e.className,j=e.labelClass,S=e.placeholder,E=e.isClearable,w=e.cacheOptions,C=e.isMulti,q=e.isDisabled,I=e.defaultOptions,T=Object(b.a)().t,R=E?l.a:i.a;return r.a.createElement(o.a,{className:c()(O)},r.a.createElement(u.a,{className:c()(j),htmlFor:a},s),r.a.createElement(R,{cacheOptions:w,defaultOptions:I,loadOptions:d,onChange:function(e){v(p,e)},value:y,isClearable:E,className:c()({"is-invalid":!!(null===(t=m[p])||void 0===t?void 0:t.length)}),placeholder:S||T("common.default-select-placeholder"),styles:h,isMulti:C,isDisabled:q,onBlur:g}),(null===(n=m[p])||void 0===n?void 0:n.length)?r.a.createElement(f.a,{errors:m[p]}):null)}y.defaultProps={isClearable:!0,cacheOptions:!0,defaultOptions:!0},y.propTypes={errors:d.a.object.isRequired,id:d.a.oneOfType([d.a.string,d.a.number]),value:d.a.oneOfType([d.a.shape({label:d.a.string,value:d.a.oneOfType([d.a.string,d.a.number])}),d.a.array]),label:d.a.any.isRequired,name:d.a.string.isRequired,handleBlur:d.a.func,setFieldValue:d.a.func.isRequired,loadOptions:d.a.func.isRequired,className:d.a.string,labelClass:d.a.string,placeholder:d.a.string,isClearable:d.a.bool,isMulti:d.a.bool,isDisabled:d.a.bool,cacheOptions:d.a.bool,defaultOptions:d.a.oneOfType([d.a.bool,d.a.array])}},"XgT/":function(e,t,n){"use strict";var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i),o=n("nc57"),u=n("9Koi"),s=n("ok1R"),c=n("rhny"),f=n("R5y6"),m=n("6jMY"),d=n("6ukn"),b=n("Bg/h"),p=n("sOKU");function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function h(e){var t,n=e.fromList,i=e.values,l=e.errors,o=e.handleTagsChange,g=e.handleIntegrationChange,h=e.handleClientChange,y=e.calculation,O=Object(u.a)().t,j=v(Object(a.useState)(n),2),S=j[0],E=j[1];return r.a.createElement(s.a,null,r.a.createElement(c.a,{md:12},!n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{className:"limiter",name:"tags",label:O("campaigns.form.tags-label"),value:i.tags,setFieldValue:o,errors:l,loadOptions:d.a,isMulti:!0,isClearable:!1}),r.a.createElement(f.a,{className:"limiter",id:"integration",name:"integration",label:O("campaigns.form.channel-label"),value:i.integration,setFieldValue:g,errors:l,loadOptions:m.a})),r.a.createElement("div",{className:"sub-label-bottom text-middle mb-4"},r.a.createElement("p",null,O("campaigns.form.clients-count",{count:y?O("campaigns.form.calculation"):null===(t=i.clients)||void 0===t?void 0:t.length})),r.a.createElement("a",{onClick:function(){return E(!S)}},O(S?"campaigns.form.hide":"campaigns.form.see-all"))),S&&r.a.createElement(b.a,{values:i,errors:l,setFieldValue:h}),r.a.createElement("div",{className:"text-right"},r.a.createElement(p.a,{color:"primary"},O("campaigns.form.subscribe-btn")))))}h.propTypes={fromList:l.a.bool,values:l.a.object.isRequired,errors:l.a.object.isRequired,handleClientChange:l.a.func.isRequired,handleTagsChange:l.a.func.isRequired,handleIntegrationChange:l.a.func.isRequired,calculation:l.a.bool};var y=h,O=n("MwQV");function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function S(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function C(e){var t=e.initialData,n=e.handleSubmit,i=e.afterSave,l=e.fromFilters,u=Object(a.useCallback)((function(e,t){var a={ids:e.clients?e.clients.map((function(e){return e.value})):[]};n(a).data((function(e){t.setSubmitting(!1),i(e)})).validation((function(e,n){t.setErrors(n),t.setSubmitting(!1)})).catch((function(){t.setSubmitting(!1)}))}),[n,i]),s=E(Object(a.useState)(!1),2),c=s[0],f=s[1],m=Object(a.useCallback)((function(e,n,a,r){f(!0),l?O.a.call("get","/methods/campaigns/clients-from-filters",{filters:JSON.stringify(t.filters),selected:JSON.stringify(t.selected),integration_id:e}).data((function(e){f(!1),setTimeout((function(){r(Object(b.b)(e.clients))}))})):O.a.call("get","/methods/campaigns/clients",{tags:null==n?void 0:n.map((function(e){return e.value})),integration_id:e}).data((function(e){f(!1),setTimeout((function(){r(Object(b.b)(e.clients))}))}))}),[l,t.filters,t.selected]);return r.a.createElement(o.a,{initialValues:t,handleSubmit:u,renderForm:function(e){var t=e.setFieldValue,n=e.values,a=e.errors,i=e.setErrors,o=S(e,["setFieldValue","values","errors","setErrors"]);return r.a.createElement(y,j({},o,{errors:a,setErrors:i,values:n,fromList:l,calculation:c,handleTagsChange:function(e,a){var r,i;t(e,a),m(null===(r=n.integration)||void 0===r?void 0:r.value,a,null===(i=n.sendViaIntegration)||void 0===i?void 0:i.value,(function(e){return t("clients",e)}))},handleIntegrationChange:function(e,a){var r;t(e,a),a||(t("clients",null),t("new_clients",null)),m(a?a.value:null,n.tags,null===(r=n.sendViaIntegration)||void 0===r?void 0:r.value,(function(e){return t("clients",e)}))},handleClientChange:function(e,n){t(e,n)}}))}})}C.propTypes={initialData:l.a.object.isRequired,handleSubmit:l.a.func.isRequired,afterSave:l.a.func.isRequired,fromFilters:l.a.bool};t.a=C},dbgk:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i);function o(e){var t=e.children;return r.a.createElement("h1",{className:"title-main mb-3"},t)}o.propTypes={children:l.a.any.isRequired}},xilt:function(e,t,n){"use strict";n("q1tI"),n("qKvR"),n("i8i4"),n("17x9");var a=n("njTy"),r=(n("iYmT"),n("FUBA"),n("1m/E")),i=n("QDav"),l=n("vwsU"),o=Object(l.b)(a.a),u=Object(r.a)(o),s=Object(i.b)(u);t.a=s}}]);