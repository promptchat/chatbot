(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"19iC":function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return m}));var a=n("rpa7"),r=n("J3gs"),i=n("YOdH"),l=n("gmZo"),o=n("q1tI");function c(){return function(e){return!e||e.is_am_pm?"hh:mm a":"HH:mm"}(Object(a.a)())}function s(){var e=Object(i.a)(),t=c();return Object(o.useCallback)((function(n){return Object(l.a)(1e3*n).tz(e).format(t)}),[t,e])}function u(){var e=Object(r.a)();return c()+" "+e}function m(){var e=Object(i.a)(),t=u();return Object(o.useCallback)((function(n){return Object(l.a)(1e3*n).tz(e).format(t)}),[t,e])}},"1QrW":function(e,t,n){"use strict";var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i),o=n("sPdi"),c=n("jrRI"),s=n("3OM0"),u=n("L3zb"),m=n("TSYQ"),d=n.n(m);function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function v(e){var t,n,a=e.id,i=e.label,l=e.errors,m=e.name,v=e.onChange,b=e.className,h=e.phone,g=void 0!==h&&h,y=p(e,["id","label","errors","name","onChange","className","phone"]);return r.a.createElement(c.a,{className:d()(b)},r.a.createElement(s.a,{htmlFor:a},i),r.a.createElement(u.a,f({id:a,name:m,type:"text",onChange:function(e){g&&e.target.value&&"+"!==e.target.value[0]&&(e.target.value="+"+e.target.value);var t=e.target.value;(g?/^\+[0-9]*$/:/^[0-9]*$/).test(t)&&v(e)}},y,{invalid:!!(null===(t=l[m])||void 0===t?void 0:t.length)})),(null===(n=l[m])||void 0===n?void 0:n.length)?r.a.createElement(o.a,{errors:l[m]}):null)}v.propTypes={onChange:l.a.func.isRequired,errors:l.a.object.isRequired,id:l.a.oneOfType([l.a.string,l.a.number]),label:l.a.any.isRequired,name:l.a.string.isRequired,className:l.a.string,phone:l.a.bool},t.a=r.a.memo(v)},3:function(e,t){},"6jMY":function(e,t,n){"use strict";n.d(t,"b",(function(){return r}));var a=n("MwQV");function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(t){return new Promise((function(n){var r={q:t};e&&(r.type=e),a.a.call("get","/methods/integrations/search",r).data((function(e){n(e.map((function(e){return{label:e.name,value:e.id,integration:e}})))}))}))}}var i=r();t.a=i},"6ukn":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("MwQV");function r(e){return new Promise((function(t){a.a.call("get","/methods/tags/search-company-tags",{q:e}).data((function(e){t(e.map((function(e){return{label:e.name,value:e.id}})))}))}))}},"A+wq":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Bn}));var a=n("q1tI"),r=n.n(a),i=n("Ty5D"),l=n("TtP3"),o=n("17x9"),c=n.n(o),s=n("rpa7"),u=n("/MKj"),m=n("7yic"),d=n("MwQV"),f=n("jNYE"),p=function(e){return function(t,n){t(function(e){return{type:m.a.CLIENTS_LOADING,payload:{list:e}}}(e));var a=n().liveChat.getIn([e,"ids"]).size;return d.a.call("get","/methods/live-chat/clients-list",{offset:a,list:e}).data((function(n){t(function(e,t){return{type:m.a.CLIENTS_LOADED,payload:{list:e,data:t}}}(e,n))})).catch((function(n,a){t(function(e,t){return{type:m.a.CLIENTS_LOADING_ERROR,payload:{list:e,errors:t}}}(e,a))}))}},v=function(){return function(e){return d.a.call("get","/methods/live-chat/meta").data((function(t){e({type:m.a.META,payload:{data:t}})}))}},b=function(e){return function(t,n){e?n().liveChat.getIn(["clientsMap",e.toString()])?t({type:m.a.SET_ACTIVE_CLIENT,payload:e}):d.a.call("get","/methods/live-chat/get-client/".concat(e)).data((function(e){t({type:m.a.SET_LOADED_ACTIVE_CLIENT,payload:e})})):t({type:m.a.SET_ACTIVE_CLIENT,payload:e})}},h=function(e){return function(t,n){var a=n().liveChat,r=a.getIn(["oldClientMessages",0,"id"]);if(a.get("oldMessagesHasMore")){t({type:m.a.CLIENT_MESSAGES_LOADING,payload:null});var i={};return r&&(i.lastId=r),d.a.call("get","/methods/live-chat/get-messages/".concat(e),i).data((function(e){var n;t((n=e,{type:m.a.CLIENT_MESSAGES_LOADED,payload:n}))}))}}},g=n("05OR"),y=n("HlzF");function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function w(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(a.useState)(null),r=E(n,2),i=r[0],l=r[1];function o(){var n=new y.Howl({src:[e]});t&&n.loop();var a=n.play();l((function(){return function(){return n.stop(a)}}))}var c=function(){return setTimeout(o,1e3)};return[c,i]}var j=n("gQBd");function C(){return Object(u.e)((function(e){return e.liveChat.getIn(["clientsMap",e.liveChat.get("activeClientId")])}))}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function M(e){var t=e.setActiveClientChannel,n=e.openedChatId,i=e.children,l=e.updateClientsLastMessageDate,o=e.addClientAskingLivechat,c=e.handleVisitorGotOperator,m=e.openChatWithClient,d=e.updateClient,f=e.loadClients,p=e.needPreloadClients,v=e.addNewMessage,b=e.handleConversationStopped,h=e.handleClientDidNotGetOperator,y=e.clientSessionOpened,E=e.clientSessionClosed,O=Object(s.a)();Object(a.useEffect)((function(){n?p?f().then((function(){m(n)})):m(n):m(null)}),[n]),function(e){var t=Object(u.e)((function(e){return!!e.liveChat.getIn(["meta","liveClients"])})),n=N(w("/audio/bring.mp3",!0),2),r=n[0],i=n[1],l=e.user_notifications_setting.site_long_notifications&&t;Object(a.useEffect)((function(){l?r():i&&i()}),[l]),Object(a.useEffect)((function(){return function(){i&&i()}}),[i])}(O);var S=N(w("/audio/notification.mp3"),1)[0],M=C(),T=null==M?void 0:M.id.toString(),I=function(){var e=[];return O.departments.forEach((function(t){e.push(j.a.private("Department.".concat(t.id)))})),e.push(j.a.private("Company.".concat(O.company_id,".Department"))),e};return Object(a.useEffect)((function(){I().forEach((function(e){e.listen("VisitorAskingForLivechat",(function(e){var t=e.client;o(t)})).listen("VisitorGotLivechatOperator",(function(e){var t=e.client;c(t,O.id)})).listen("ClientDataChanged",(function(e){var t=e.clientId,n=e.data;d(t,n)})).listen("StopConversationWithClient",(function(e){var t=e.clientId;b(t)})).listen("VisitorDidNotGetOperator",(function(e){var t=e.client;h(t)})).listen("ClientSessionOpened",(function(e){var t=e.client;y(t)})).listen("ClientSessionClosed",(function(e){var t=e.client,n=e.hasOtherSessions;E(t,n)}))}))}),[O]),Object(a.useEffect)((function(){var e=I();return e.forEach((function(e){e.listen("ClientNewMessage",(function(e){var t,n=e.message,a=e.client;n.client=a,l(n);var r=Boolean(n.user&&(null===(t=n.user)||void 0===t?void 0:t.id.toString())!==O.id.toString());(n.type===g.e||r)&&O.user_notifications_setting.site_long_notifications&&S()}))})),function(){e.forEach((function(e){e.stopListening("ClientNewMessage")}))}}),[O,T]),function(e){var t=C(),n=null==t?void 0:t.id.toString();Object(a.useEffect)((function(){if(n)return e(n)}),[n,e])}(Object(a.useCallback)((function(e){if(e){var n=j.a.private("ClientInternal.".concat(e));return n.listen("ClientNewMessage",(function(e){var t=e.message,n=e.client;t.client=n,v(t)})),t(n),function(){n.stopListening("ClientNewMessage"),t(null)}}}),[v,t])),r.a.createElement(r.a.Fragment,null,i)}M.propTypes={openedChatId:c.a.string,needPreloadClients:c.a.bool.isRequired,updateClientsLastMessageDate:c.a.func.isRequired,addClientAskingLivechat:c.a.func.isRequired,handleVisitorGotOperator:c.a.func.isRequired,openChatWithClient:c.a.func.isRequired,updateClient:c.a.func.isRequired,loadClients:c.a.func.isRequired,addNewMessage:c.a.func.isRequired,handleConversationStopped:c.a.func.isRequired,handleClientDidNotGetOperator:c.a.func.isRequired,clientSessionOpened:c.a.func.isRequired,clientSessionClosed:c.a.func.isRequired,setActiveClientChannel:c.a.func.isRequired,children:c.a.any.isRequired};var T=Object(u.c)((function(e){var t;return{needPreloadClients:!(null===(t=e.liveChat.get("allClients","ids"))||void 0===t?void 0:t.size)}}),(function(e){return{openChatWithClient:function(t){return e(b(t))},updateClientsLastMessageDate:function(t){e(function(e){return{type:m.a.CLIENTS_UPDATE_LAST_MESSAGE,payload:e}}(t))},addClientAskingLivechat:function(t){e(function(e){return function(t,n){t(v());var a=n().auth.getIn(["user","id"]);return e.assign_operator_id&&e.assign_operator_id!==a?a!==e.operator_id?t({type:m.a.CLIENTS_DID_NOT_GET_OPERATOR,payload:e}):void 0:t({type:m.a.CLIENTS_ADD_ASKING_LIVECHAT,payload:e})}}(t))},handleVisitorGotOperator:function(t,n){e(function(e){var t=e.client,n=e.operatorId;return function(e){return e(v()),t.operator_id!==n?e({type:m.a.CLIENTS_GOT_OPERATOR,payload:{client:t,operatorId:n}}):e({type:m.a.CLIENTS_ADD_ASKING_LIVECHAT,payload:t})}}({client:t,operatorId:n}))},handleClientDidNotGetOperator:function(t){e(function(e){return function(t){return t(v()),t({type:m.a.CLIENTS_DID_NOT_GET_OPERATOR,payload:e})}}(t))},handleConversationStopped:function(t){e(function(e){return{type:m.a.CONVERSATION_STOPPED,payload:e}}(t))},updateClient:function(t,n,a){e(function(e,t){return{type:m.a.UPDATE_CLIENT_DATA,payload:{clientId:e,data:t}}}(t,n))},loadClients:function(t){return e(p(t))},addNewMessage:function(t){e(function(e){return{type:m.a.CLIENT_NEW_MESSAGE,payload:e}}(t))},clientSessionOpened:function(t){var n;e((n=t,function(e){return e(v()),e({type:m.a.ONLINE_VISITOR_NEW_SESSION_OPENED,payload:n})}))},clientSessionClosed:function(t,n){e(function(e,t){return function(n){return n(v()),n({type:m.a.ONLINE_VISITOR_SESSION_CLOSED,payload:{client:e,hasMoreSessions:t}})}}(t,n))}}}))(M),I=n("9Koi"),_=function(){var e=Object(I.a)().t;return r.a.createElement("div",{className:"w-100 text-large text-center align-self-center"},e("liveChat.chat-window.select-chat-placeholder"))},R=n("6Rhw"),k=n("sOKU"),x=n("TSYQ"),A=n.n(x);function q(e){var t=e.children,n=e.className;return r.a.createElement("div",{className:A()("sidebar-block",n)},t)}q.propTypes={children:c.a.any.isRequired,className:c.a.string};var D=q,L=n("ma3e");function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function V(e){var t=e.renderForm,n=e.renderView,i=P(Object(a.useState)(!1),2),l=i[0],o=i[1],c=function(){return o((function(e){return!e}))};return r.a.createElement(D,null,l?t(c):r.a.createElement("div",{className:"d-flex align-items-baseline justify-content-between"},n(),r.a.createElement(k.a,{onClick:c,color:"link",className:"no-shadow text-dec-none py-0 px-0"},r.a.createElement(L.o,{className:"icon-size-20 color-gray position-relative mb-1"}))))}V.propTypes={renderForm:c.a.func.isRequired,renderView:c.a.func.isRequired};var z=n("nc57"),W=n("x37D");function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e){var t=e.clientId,n=e.fieldName,a=e.fieldValue,i=e.renderField,l=e.renderView,o=e.values,c=void 0===o?{}:o,s=Object(I.a)().t;return r.a.createElement(V,{key:t,renderView:l,renderForm:function(e){return r.a.createElement(z.a,{initialValues:H(U({},n,a),c),handleSubmit:function(a,r){(function(e,a){var r=a.setSubmitting,i=a.setErrors;return d.a.call("post","/methods/clients/".concat(t),{},H(U({},n,e[n]),e)).validation((function(e,t){i(t),r(!1)})).catch((function(){r(!1)}))})(a,r).then(e)},renderForm:function(t){var n=t.handleChange,a=t.handleBlur,l=t.values,o=t.errors,c=t.isSubmitting;return r.a.createElement("div",null,i({handleChange:n,handleBlur:a,values:l,errors:o}),r.a.createElement(W.a,{className:"mr-3 mb-2",disabled:c},s("common.saveBtnText")),r.a.createElement(k.a,{className:"mb-2",onClick:e},s("common.cancelBtnText")))}})}})}G.propTypes={clientId:c.a.oneOfType([c.a.string,c.a.number]).isRequired,fieldName:c.a.string.isRequired,fieldValue:c.a.any,renderField:c.a.func.isRequired,renderView:c.a.func.isRequired,values:c.a.object};var $=G,K=n("1QrW");function Q(e){var t=e.client,n=Object(I.a)().t,i=t.name,l=t.variables,o=Object(a.useCallback)((function(){return r.a.createElement("div",null,i,r.a.createElement("br",null),l.first_name," ",l.last_name," ",l.phone_number)}),[i,l]),c=Object(a.useCallback)((function(e){var t=e.handleChange,a=e.handleBlur,i=e.values,l=e.errors;return r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,{className:"pt-0",id:"first_name",name:"first_name",label:n("liveChat.chat-window.details.first_name-label"),placeholder:n("liveChat.chat-window.details.first_name-placeholder"),type:"text",onChange:t,onBlur:a,value:i.first_name||"",errors:l}),r.a.createElement(R.a,{className:"pt-0",id:"last_name",name:"last_name",label:n("liveChat.chat-window.details.last_name-label"),placeholder:n("liveChat.chat-window.details.last_name-placeholder"),type:"text",onChange:t,onBlur:a,value:i.last_name||"",errors:l}),r.a.createElement(K.a,{phone:!0,className:"pt-0",id:"phone_number",name:"phone_number",label:n("liveChat.chat-window.details.phone_number-label"),placeholder:n("liveChat.chat-window.details.phone_number-placeholder"),type:"text",onChange:t,onBlur:a,value:i.phone_number||"",errors:l}))}),[n]);return r.a.createElement(r.a.Fragment,null,r.a.createElement($,{clientId:t.id,fieldName:"name",fieldValue:i||"",renderView:o,renderField:c,values:l}))}Q.propTypes={client:c.a.instanceOf(f.a).isRequired};var Y=n("XRgj");function J(e){var t=e.name,n=e.value;return n?r.a.createElement("div",{className:"text-middle d-flex mt-1 mb-1"},r.a.createElement("span",{className:"mr-1"},t),r.a.createElement("span",null,"function"==typeof n?n():n)):null}J.propTypes={name:c.a.string.isRequired,value:c.a.any};var X=n("mDHu"),Z=n("zEWu"),ee=n("T7vI");function te(e){var t=e.service,n=e.variables,a=void 0===n?{}:n,i=Object(I.a)().t,l=null,o=[];switch(+t){case Y.i:l=r.a.createElement(r.a.Fragment,null,r.a.createElement(J,{name:i("liveChat.chat-window.details.variable-ip"),value:a.ip}),Object(Z.a)(a.geo)?r.a.createElement(J,{name:i("liveChat.chat-window.details.variable-geo"),value:function(){return r.a.createElement(X.a,{geo:a.geo})}}):null);break;case Y.e:case Y.h:case Y.b:o=[],a.first_name&&o.push(a.first_name),a.last_name&&o.push(a.last_name),l=r.a.createElement(J,{name:i("liveChat.chat-window.details.variable-name"),value:o.join(" ")});break;case Y.f:case Y.g:case Y.d:case Y.c:l=r.a.createElement(J,{name:i("liveChat.chat-window.details.variable-phone"),value:a.phone_number})}return r.a.createElement(D,null,l&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"client-info-title color-black"},i("liveChat.chat-window.details.variables-title")),r.a.createElement(ee.a,{data:a})))}te.propTypes={service:c.a.number.isRequired,variables:c.a.object.isRequired};var ne=r.a.memo(te),ae=n("xilt"),re=n("6ukn");function ie(e){var t=e.clientId,n=e.tags;n=n.map((function(e){return{label:e.name,value:e.id}}));var i=Object(I.a)().t,l=Object(a.useCallback)((function(e){var n=(e||[]).map((function(e){return{id:e.__isNew__?null:e.value,name:e.label}}));d.a.call("post","/methods/tags/add-client-tags/".concat(t),{},{tags:n})}),[t]);return r.a.createElement(D,null,r.a.createElement("p",{className:"mb-2"},i("liveChat.chat-window.details.tags-title")),r.a.createElement(ae.a,{value:n,isMulti:!0,defaultOptions:!0,loadOptions:re.a,onChange:l}))}ie.defaultValue={tags:c.a.array},ie.propTypes={clientId:c.a.oneOfType([c.a.string,c.a.number]).isRequired,tags:c.a.array};var le=r.a.memo(ie),oe=n("3OM0");function ce(e){var t=e.client,n=Object(I.a)().t,i=t.note,l=Object(a.useCallback)((function(e){var t=e.handleChange,a=e.handleBlur,i=e.values,l=e.errors;return r.a.createElement(R.a,{className:"pt-0",id:"note",name:"note",label:n("liveChat.chat-window.details.note-label"),placeholder:n("liveChat.chat-window.details.note-placeholder"),type:"textarea",onChange:t,onBlur:a,value:i.note||"",errors:l})}),[n]),o=Object(a.useCallback)((function(){return r.a.createElement("div",null,r.a.createElement(oe.a,{className:"client-info-title color-black pr-1",htmlFor:"note"},n("liveChat.chat-window.details.note-title")),r.a.createElement("i",{className:"d-block"},i||n("liveChat.chat-window.details.note-empty-text")))}),[i,n]);return r.a.createElement($,{clientId:t.id,fieldName:"note",fieldValue:i||"",renderView:o,renderField:l})}ce.propTypes={client:c.a.instanceOf(f.a).isRequired};var se=r.a.memo(ce),ue=n("FN/A"),me=n("83d4"),de=n("LEWT");function fe(e){var t=e.clientId,n=e.responsibleOperator,a=Object(s.a)(),i=Object(u.d)(),l=Object(I.a)().t;return n&&n.id===a.id?r.a.createElement(k.a,{className:"leave-chat-btn",color:"outline-danger",onClick:function(){i(Object(de.c)("Do you really want leave conversation?")).then((function(){d.a.call("post","/methods/live-chat/stop-conversation/".concat(t))}))}},l("liveChat.chat-window.details.leave-chat-btn")):null}fe.propTypes={clientId:c.a.oneOfType([c.a.string,c.a.number]).isRequired,responsibleOperator:c.a.instanceOf(me.d)};var pe=fe,ve=n("FCdT");function be(e){return new Promise((function(t){var n={q:e};d.a.call("get","/methods/user/search",n).data((function(e){t(e.map((function(e){return{label:e.name,value:e.id,user:me.d.instantiate(e)}})))}))}))}var he=n("QDav");function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Ee(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Oe(){return(Oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var we=function(e){var t=e.innerProps,n=e.isDisabled,a=e.data;return n?null:r.a.createElement("div",Oe({className:"d-flex align-items-center p-2"},t),r.a.createElement(ue.a,{showIsOnline:!0,user:a.user}),r.a.createElement("span",{className:"ml-2"},a.label))},je=function(e){var t=e.getValue,n=Ee(e,["getValue"]),a=ge(t(),1)[0];return a?r.a.createElement("div",{className:"d-flex align-items-center p-2"},r.a.createElement(ue.a,{showIsOnline:!0,user:a.user}),r.a.createElement("span",{className:"ml-2"},a.label)):r.a.createElement(ve.z.SingleValue,Oe({},n,{getValue:t}))};function Ce(e){var t=e.operator,n=e.clientId,a=Object(I.a)().t;return r.a.createElement("div",null,r.a.createElement("label",null,a("liveChat.chat-window.assign")),r.a.createElement(he.a,{components:{Option:function(e){return r.a.createElement(we,Oe({},e,{isDisabled:e.value===(null==t?void 0:t.id)}))},SingleValue:je},value:t?{value:t.id,label:t.name,user:t}:null,defaultOptions:!0,loadOptions:be,onChange:function(e){var t=e.value;d.a.call("post","/methods/live-chat/set-assign-operator/".concat(n),{},{id:t})}}))}Ce.defaultValue={},Ce.propTypes={operator:c.a.instanceOf(me.d),clientId:c.a.number.isRequired};var Ne=Ce;function Se(e){var t=e.operator,n=e.clientId,a=e.assignOperator,i=Object(I.a)().t;return r.a.createElement(D,null,r.a.createElement("p",{className:"client-info-title color-black"},i("liveChat.chat-window.details.responsible-operator-title")),t?r.a.createElement("div",{className:"d-flex flex-wrap justify-content-between"},r.a.createElement("div",{className:"d-flex align-items-center mr-2 mb-2"},r.a.createElement(ue.a,{showIsOnline:!0,user:t}),r.a.createElement("span",{className:"ml-2"},t.name)),r.a.createElement(pe,{clientId:n,responsibleOperator:t})):r.a.createElement("div",{className:"text-center"},i("liveChat.chat-window.details.no-responsible-operator")),r.a.createElement(Ne,{operator:a,clientId:n}))}Se.propTypes={operator:c.a.instanceOf(me.d),assignOperator:c.a.instanceOf(me.d),clientId:c.a.number.isRequired};var Me=r.a.memo(Se);function Te(e){var t=e.attachment,n=e.fullWidth;switch(t.type){case g.b:return r.a.createElement("div",{className:"py-2",style:{maxWidth:n?200:100}},r.a.createElement("img",{src:t.data.url,alt:"",className:"img-fluid"}));case g.c:return r.a.createElement("div",{className:"py-2",style:{maxWidth:n?300:150}},r.a.createElement("video",{controls:"controls",className:"chat-message-video"},r.a.createElement("source",{src:t.data.url})));case g.a:return r.a.createElement("div",{className:"chat-message-file my-1"},r.a.createElement("a",{href:t.data.url},r.a.createElement(L.t,{className:"icon-size-20 color-gray"})))}return null}Te.propTypes={attachment:c.a.object,fullWidth:c.a.bool};var Ie=Te;function _e(e){switch(e.type){case g.f:return null;case g.d:return"/img/default_chatbot_img.svg";case g.e:return"/img/default_user_image.svg"}}function Re(e){var t=e.chatMessage,n=e.isPreview,a=e.formatMsgTime,i=function(e){return e.isFromClient?e.client:e.isFromOperator?e.user:{name:"Bot"}}(t),l=_e(t);return r.a.createElement("div",{className:A()("message-container clearfix",{"from-client":t.isFromClient,"from-operator":t.isFromOperator,"from-bot":t.isFromBot,"from-system":t.isSystem,preview:n})},r.a.createElement("div",{className:"message-wrapper"},r.a.createElement("div",{className:"message py-1"},l?r.a.createElement("img",{className:"message-img-autor mx-sm-4 mx-2",src:l,alt:"author img"}):null,r.a.createElement("div",{className:"message-content text-block"},r.a.createElement("div",{className:"chat-message color-black",dangerouslySetInnerHTML:{__html:t.message}}),r.a.createElement("div",null,t.attachment?r.a.createElement(Ie,{attachment:t.attachment,fullWidth:!t.message}):null),t.isSystem?null:r.a.createElement("div",{className:"message-info-mark mt-2"},r.a.createElement("span",{className:"color-black mr-2"},null==i?void 0:i.name),t.created_at?r.a.createElement("span",{className:"color-dark-gray"},a(t.created_at)):null)))))}Re.defaultProps={isPreview:!1},Re.propTypes={chatMessage:c.a.instanceOf(g.g).isRequired,isPreview:c.a.bool,formatMsgTime:c.a.func.isRequired};var ke=r.a.memo(Re),xe=n("RotF"),Ae=n.n(xe),qe=n("wDsf");function De(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Le(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Pe=n("YOdH"),Fe=n("19iC"),Ve=n("gmZo");function ze(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=Object(Pe.a)(),n=Object(Fe.c)(),r=Object(Fe.d)(),i=Object(I.a)(),l=i.t;return Object(a.useCallback)((function(a){var i=Object(Ve.a)(1e3*a).tz(t);if(((new Date).getTime()-i.toDate().getTime())/1e3<3600&&e)return i.fromNow();if(i.isSame(new Date,"day"))return l("common.date.today")+", "+i.format(r);var o=new Date;return i.isSame(o.setTime(o.getTime()-864e5),"day")?l("common.date.yesterday")+", "+i.format(r):i.format(n)}),[n,t,r,l,e])}function We(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Be(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function He(e){var t,n,i,l=e.client,o=e.activeClientChannel,c=e.newMessages,s=e.oldMessages,u=e.loading,m=e.hasMore,d=e.loadMessages,f=null===(t=l.name)||void 0===t?void 0:t.toString(),p=l.id.toString(),v=ze(),b=We(Object(a.useState)(null),2),h=b[0],y=b[1],E=We(function(e,t,n){var r=e.id.toString(),i=Object(qe.a)(r),l=Object(a.useRef)(),o=De(Object(a.useState)(!1),2),c=o[0],s=o[1],u=De(Object(a.useState)(!1),2),m=u[0],d=u[1],f=Object(a.useCallback)((function(){var e=l.current;return e.clientHeight+e.scrollTop>=e.scrollHeight-50}),[l]),p=Object(a.useCallback)((function(){var e=l.current;e.scrollTop=e.scrollHeight}),[l]);Object(a.useEffect)((function(){!t&&r&&(s(!1),d(!1))}),[r,t]),Object(a.useEffect)((function(){!c&&t&&r&&(p(),s(!0),d(!0))}),[p,t,c,r]),Object(a.useEffect)((function(){r===i&&c&&m&&p()}),[n,c,r,i]);var v=Object(a.useCallback)((function(){var e=f();e!==m&&d(e)}),[m,d,f]);return[l,v,c,f]}(l,s,c),4),O=E[0],w=E[1],j=E[2],C=E[3];Object(a.useEffect)((function(){d(p)}),[p,d]);var N=Object(a.useCallback)((function(e,t){return e&&!t?g.g.instantiate({id:"preview",message:e,created_at:null,client:l,type:g.e}):null}),[f]);Object(a.useEffect)((function(){if(o)return o.listenForWhisper("typing",(function(e){var t=e.message,n=e.fromOperator;y(N(t,n)),setTimeout((function(){y(null)}),2e3)})),function(){o.stopListeningForWhisper("typing")}}),[o,N]);var S,M=null===(n=O.current)||void 0===n?void 0:n.scrollHeight,T=null===(i=O.current)||void 0===i?void 0:i.scrollTop;return Object(a.useEffect)((function(){var e=O.current;if(e&&M&&!C()){var t=e.scrollHeight-M;e.scrollTop=T+t}}),[s,h]),S=s?r.a.createElement("div",{className:"pr-4"},r.a.createElement(Ae.a,{threshold:30,isReverse:!0,loadMore:function(){m&&!u&&j&&d(p)},hasMore:m&&!u&&j,loader:null,useWindow:!1,getScrollParent:function(){return O.current}},s.map((function(e,t){return r.a.createElement(ke,{key:"".concat(t,"-").concat(e.id),chatMessage:e,formatMsgTime:v})}))),c.map((function(e){return r.a.createElement(ke,{key:e.id,chatMessage:e,formatMsgTime:v})})),h?r.a.createElement(ke,{chatMessage:h,formatMsgTime:v}):null):null,r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"small-scrollbar messages-list messages-list-scrollbar w-100 pr-2",ref:O,onScroll:w},S))}He.propTypes={client:c.a.instanceOf(f.a).isRequired,activeClientChannel:c.a.object,newMessages:c.a.object.isRequired,oldMessages:c.a.object,loading:c.a.bool,hasMore:c.a.bool,loadMessages:c.a.func.isRequired};var Ue=Object(u.c)((function(e){var t=e.liveChat;return{newMessages:t.get("newClientMessages"),oldMessages:t.get("oldClientMessages"),hasMore:t.get("oldMessagesHasMore"),loading:t.get("clientMessagesLoading")}}),(function(e){return{loadMessages:function(t){return e(h(t))}}}))(He),Ge=n("7BfX"),$e=n("55Ip");function Ke(e){var t,n=e.variables,a=e.integrationType,i=[];switch(n.first_name&&i.push(n.first_name),n.last_name&&i.push(n.last_name),n.phone_number&&i.push(n.phone_number),+a){case Y.i:t=r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"mr-2"},i.join(" ")),r.a.createElement("div",{className:"d-flex"},r.a.createElement("span",{className:"mr-2"},n.ip),Object(Z.a)(n.geo)?r.a.createElement(X.a,{geo:n.geo}):null));break;default:t=r.a.createElement("div",null,i.join(" "))}return t?r.a.createElement("div",{className:"mb-2 d-flex flex-wrap"},t):null}Ke.propTypes={variables:c.a.object.isRequired,integrationType:c.a.number.isRequired};var Qe=Ke,Ye=n("HayB");function Je(e){var t=e.onClick,n=e.href,a=r.a.createElement(L.d,{className:"icon-size-20 color-blue mb-2"});return t?r.a.createElement("button",{className:"btn btn-link no-shadow text-dec-none d-flex align-items-center px-2",onClick:t},a):n?r.a.createElement($e.a,{className:"btn btn-link no-shadow text-dec-none d-flex align-items-center px-2",to:n},a):null}function Xe(e){var t=e.onClick,n=e.href,a=e.client,i=e.toggleShowDetails,l=a.integration.service,o=a.variables;return r.a.createElement("div",{className:"mobile-chat-header-container pt-3 pb-2 pl-1"},r.a.createElement(Je,{onClick:t,href:n}),r.a.createElement("button",{type:"button",onClick:i,className:"current-interlocutor btn-link no-shadow border-0 w-100 px-1 d-flex align-items-center text-left"},r.a.createElement("div",{className:"d-flex flex-wrap align-items-center img-block mr-3 mb-2"},Ye.b[l]()),r.a.createElement("div",{className:"d-flex flex-wrap align-items-center"},r.a.createElement("div",{className:"w-100 mb-2"},a.name),o&&r.a.createElement(Qe,{variables:o,integrationType:l}))))}Je.propTypes={onClick:c.a.func,href:c.a.string},Xe.propTypes={onClick:c.a.func,href:c.a.string,client:c.a.instanceOf(f.a).isRequired,toggleShowDetails:c.a.func.isRequired};var Ze=Xe;function et(e){var t=e.file,n=e.removeFile;return r.a.createElement("div",{className:"d-flex align-items-center px-2"},r.a.createElement(L.t,{className:"icon-size-14 color-gray mr-1"}),r.a.createElement("span",null,t.name),r.a.createElement("button",{onClick:n,className:"btn btn-link text-dec-none no-shadow p-1"},r.a.createElement(L.V,{className:"icon-size-12 color-red"})))}et.propTypes={file:c.a.shape({name:c.a.string.isRequired}),removeFile:c.a.func.isRequired};var tt=r.a.memo(et);function nt(e){var t=e.message,n=e.handleMessageChange,a=e.handleKeyDown,i=Object(I.a)().t;return r.a.createElement("textarea",{className:"w-100 message-text-field ml-sm-4 ml-2",onChange:n,onKeyDown:a,value:t||"",placeholder:i("liveChat.chat-window.text-editor-placeholder")})}nt.propTypes={message:c.a.string,handleMessageChange:c.a.func.isRequired,handleKeyDown:c.a.func.isRequired};var at=nt;function rt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return it(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function lt(e,t){return d.a.call("post","/methods/live-chat/pick-client/".concat(e),{},{text:t})}function ot(e){var t=e.children,n=e.clientId,i=e.color,l=e.text,o=e.afterSend,c=e.title,u=e.className,m=rt(Object(a.useState)(!1),2),d=m[0],f=m[1],p=Object(s.a)();return r.a.createElement(k.a,{className:A()(u),disabled:d,color:i,onClick:function(){f(!0),lt(n,l||p.default_conversation_message).then((function(){o&&o()})).catch((function(){f(!1)}))},type:"button",title:c},t)}ot.defaultProps={color:"warning"},ot.propTypes={clientId:c.a.oneOfType([c.a.string,c.a.number]).isRequired,children:c.a.any.isRequired,color:c.a.string,text:c.a.string,title:c.a.string,afterSend:c.a.func,className:c.a.string};var ct=r.a.memo(ot),st=r.a.forwardRef((function(e,t){var n=e.handleAddFile;return r.a.createElement("label",{className:"mb-0"},r.a.createElement("input",{ref:t,type:"file",onChange:n,className:"d-none"}),r.a.createElement(L.F,{className:"icon-size-20 color-gray position-relative ml-sm-4 ml-2 my-2"}))}));st.propTypes={handleAddFile:c.a.func.isRequired};var ut=r.a.memo(st);function mt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ft(e){var t=e.client,n=e.activeClientChannel,i=Object(I.a)().t,l=Object(s.a)(),o=t.operator_id,c=t.assign_operator_id,u=t.id.toString(),m=!o||o!==l.id,f=m?l.default_conversation_message:"",p=mt(Object(a.useState)(!1),2),v=p[0],b=p[1],h=mt(Object(a.useState)(f),2),g=h[0],y=h[1],E=mt(Object(a.useState)(null),2),O=E[0],w=E[1],j=Object(a.useRef)(),C=Object(a.useCallback)((function(){d.a.call("post","/methods/live-chat/decline-assign-operator/".concat(u))}),[u]),N=Object(a.useCallback)((function(){if(!v){b(!0);var e=g;((g||"").match(/(http[s]?|ftp):\/\/[\w\d]{1}[^\s]*/g)||[]).forEach((function(t){e=e.replace(t,'<a href="'.concat(t,'" target="_blank">').concat(t,"</a>"))}));var t=new FormData;t.append("text",e),t.append("attachment",O),d.a.call("post","/methods/live-chat/send-message/".concat(u),{},t).then((function(){q()})).finally((function(){b(!1)}))}}),[v,g,O,q,u]),S=Object(a.useCallback)((function(e){v||(n&&n.whisper("typing",{message:"operator typing message...",fromOperator:o}),y(e.target.value))}),[o,v,n]),M=Object(a.useCallback)((function(e){v||w(e.target.files[0])}),[v]),T=l.default_conversation_message,_=Object(a.useCallback)((function(){b(!0),lt(u,g||T).then((function(){y(""),b(!1)})).catch((function(){b(!1)}))}),[u,g,T]),R=Object(a.useCallback)((function(e){v||13!==e.keyCode||e.shiftKey||(m?_():N())}),[m,v,N,_]),x=Object(a.useCallback)((function(){v||w(null)}),[v]),q=Object(a.useCallback)((function(){y(""),w(null),j.current&&(j.current.files=null,j.current.value=null)}),[j,y]),D=Object(qe.a)(o);Object(a.useEffect)((function(){o!==D&&y(f)}),[o,D,m]);var L=r.a.createElement(r.a.Fragment,null,r.a.createElement(ut,{ref:j,handleAddFile:M}),r.a.createElement(at,{handleKeyDown:R,handleMessageChange:S,message:g}),m?r.a.createElement(ct,{className:"send-btn btn-link no-shadow border-0",clientId:t.id,text:g,afterSend:function(){return y("")}},r.a.createElement("img",{className:"send-icon",src:"/img/send.svg",alt:"send"})):r.a.createElement(W.a,{className:"send-btn btn-link no-shadow border-0",disabled:v||!O&&!g,onClick:N},r.a.createElement("img",{className:"send-icon",src:"/img/send.svg",alt:"send"}))),P=null;if(c){var F=c===l.id;P=r.a.createElement("div",{className:"assignment-block"},r.a.createElement("p",{className:"mb-1"},F?i("liveChat.chat-window.assigned-you"):i("liveChat.chat-window.assigned-someone",{user:t.assignOperator.name})),r.a.createElement("div",{className:"text-center"},r.a.createElement(ct,{className:"btn btn-success no-shadow border-0 mr-1",color:"success",clientId:t.id,text:g,afterSend:function(){return y("")}},i("liveChat.chat-window.pick-up")),F&&r.a.createElement(k.a,{onClick:C,color:"warning"},i("liveChat.chat-window.decline-assignment"))))}return r.a.createElement("div",{className:"mt-3"},O?r.a.createElement(tt,{file:O,removeFile:x}):null,r.a.createElement("div",{className:A()("d-flex align-items-center message-send-block",{"need-pick-user":m})},P||L))}ft.propTypes={client:c.a.instanceOf(f.a).isRequired,activeClientChannel:c.a.object};var pt=ft,vt=n("sKTO"),bt=c.a.oneOf([vt.a,vt.b,vt.c,vt.d]),ht=n("YOqN"),gt=n("bTjV");function yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Et(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Ot(e){var t=e.message,n=e.formatDateTime;return r.a.createElement("div",{style:{border:"1px solid #cecece",marginBottom:5,padding:5,borderRadius:3}},r.a.createElement("div",{style:{fontSize:13,color:"#6d6d6d",marginBottom:3}},n(t.send_at)),t.text?r.a.createElement("div",{style:{paddingLeft:15},dangerouslySetInnerHTML:{__html:t.text}}):r.a.createElement("div",null,t.trigger))}function wt(e){var t=e.clientId,n=Object(I.a)().t,i=yt(Object(a.useState)(null),2),l=i[0],o=i[1],c=yt(Object(a.useState)(!1),2),s=c[0],u=c[1],m=Object(Fe.a)();Object(a.useEffect)((function(){o(null),u(!1)}),[t]);var f,p=function(){o(null),u(!1)};return f=null!==l||s?s?r.a.createElement("div",{className:"text-center"},r.a.createElement(gt.a,null)):s||!l||l.length?l?r.a.createElement("div",null,r.a.createElement("div",null,l.map((function(e){return r.a.createElement(Ot,{key:e.id,message:e,formatDateTime:m})}))),r.a.createElement("div",{className:"text-center"},r.a.createElement(k.a,{onClick:p,block:!0},n("liveChat.chat-window.scheduled-messages.hide-btn")))):null:r.a.createElement("div",{className:"text-center"},r.a.createElement("p",null,n("liveChat.chat-window.scheduled-messages.no-scheduled-messages")),r.a.createElement(k.a,{onClick:p,block:!0},n("liveChat.chat-window.scheduled-messages.hide-btn"))):r.a.createElement("div",null,r.a.createElement(k.a,{onClick:function(){u(!0),d.a.call("get","/methods/clients/".concat(t,"/scheduled-messages")).data((function(e){o(e),u(!1)}))},block:!0},n("liveChat.chat-window.scheduled-messages.show-btn"))),r.a.createElement(D,null,r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"client-info-title color-black"},n("liveChat.chat-window.scheduled-messages.scheduled-title")),f))}Ot.propTypes={message:c.a.object.isRequired,formatDateTime:c.a.func.isRequired},wt.propTypes={clientId:c.a.number.isRequired};var jt=r.a.memo(wt);function Ct(e){var t=e.client,n=Ye.b[t.integration.service];return r.a.createElement($e.a,{to:ht.a.chatRoute.getLink("conversations",t.id),className:"d-flex w-100 client-variation"},r.a.createElement("div",{className:"service-icon-block service-icon-block_small"},n()),r.a.createElement("span",{className:"ml-1"},t.name))}Ct.propTypes={client:c.a.instanceOf(f.a).isRequired};var Nt=Ct,St=n("6jMY"),Mt=n("qtta");function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return It(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return It(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){kt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function kt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xt=Object(St.b)([Y.c,Y.d]),At={control:function(e){return Rt(Rt({},e),{},{"&, &:hover, &:focus":{borderColor:"#ced4da",boxShadow:"none"}})}};function qt(e){var t=e.phoneNumber,n=e.hideForm,l=Object(u.d)(),o=Object(I.a)().t,c=Tt(Object(a.useState)(null),2),s=c[0],p=c[1],v=Tt(Object(a.useState)(null),2),b=v[0],h=v[1],g=Object(a.useCallback)((function(e,t){l(function(e,t){return function(n,a){var r=a().liveChat,i=r.getIn(["allClients","ids"]).concat(r.getIn(["onlineClients","ids"])).concat(r.getIn(["liveClients","ids"])).concat(r.getIn(["skipped","ids"])),l=null;i.toSet().map((function(a){(l=r.getIn(["clientsMap",a])).phone===t&&l.id!==e&&d.a.call("get","/methods/live-chat/get-client/".concat(l.id)).data((function(e){n({type:m.a.UPDATE_WHOLE_CLIENT,payload:f.a.instantiate(e)})}))}))}}(e,t))}),[l]);if(s)return r.a.createElement(i.a,{to:ht.a.chatRoute.getLink("conversations",s)});return r.a.createElement("div",null,r.a.createElement(he.a,{cacheOptions:!0,defaultOptions:!0,loadOptions:xt,onChange:function(e){var t=e.value;h(t)},styles:At,className:"mb-2"}),r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement(k.a,{type:"button",color:"danger",outline:!0,onClick:n,className:"new-client-form-btn"},o("common.cancelBtnText")),r.a.createElement(k.a,{type:"button",color:"success",outline:!0,onClick:function(){if(b){var e={integration_id:b,phone_number:t,variables:[{name:"phone_number",value:t}],tags:[]};d.a.call("post","/methods/clients",{},e).data((function(e){h(null),p(e.id),g(e.id,e.phone)})).catch((function(){h(null),n()}))}},disabled:!b,className:"new-client-form-btn"},o("common.addBtnText"))))}function Dt(e){var t=e.phoneNumber,n=Tt(Object(a.useState)(!1),2),i=n[0],l=n[1],o=Object(a.useCallback)((function(){return l(!1)}),[]);return r.a.createElement("div",null,i?r.a.createElement(qt,{hideForm:o,phoneNumber:t}):r.a.createElement("div",{className:"text-center"},r.a.createElement(k.a,{type:"button",outline:!0,color:"primary",onClick:function(){return l(!0)}},r.a.createElement(Mt.a,null))))}qt.propTypes={phoneNumber:c.a.string.isRequired,hideForm:c.a.func.isRequired},Dt.propTypes={phoneNumber:c.a.string.isRequired};var Lt=Dt;function Pt(e){var t=e.clients,n=e.clientPhone,a=Object(I.a)().t;return r.a.createElement(D,null,r.a.createElement("p",{className:"client-info-title color-black"},a("liveChat.chat-window.details.other-chats-with-lead-title")),r.a.createElement("div",{className:"other-clients-list mb-3"},t.length?t.map((function(e){return r.a.createElement(Nt,{key:e.id,client:e})})):r.a.createElement("div",{className:"text-secondary text-sm-left no-other-chats"},a("liveChat.chat-window.details.no-other-chats-with-lead"))),r.a.createElement(Lt,{phoneNumber:n}))}Pt.propTypes={clients:c.a.arrayOf(c.a.instanceOf(f.a)).isRequired,clientPhone:c.a.string.isRequired};var Ft=Pt,Vt=n("jHW1"),zt=n("hBLe");function Wt(e){var t,n=e.event,a=Object(I.a)().t,i=Object(zt.a)(),l=Object(Fe.a)(),o=Object(Fe.b)(),c=(n.end_time-n.start_time)/3600>24,s=[];return n.email&&s.push(n.email),n.user_phone&&s.push(n.user_phone),t=c?r.a.createElement("div",{className:"date-block color-dark-gray text-right"},l(n.start_time)," -"," ",l(n.end_time)," "):r.a.createElement("div",{className:"date-block color-dark-gray text-right"},o(n.start_time)," - ",o(n.end_time)," ",i(n.start_time)),r.a.createElement("div",{className:"user-event-item message"},r.a.createElement("div",{className:"main-data"},n.calendar.name,": ",n.username),r.a.createElement("div",{className:"main-data"},a("liveChat.chat-window.details.contacts-subtitle")," ",s.join(", ")),n.comment?r.a.createElement("div",{className:"comment-block"},n.comment):null,t)}function Bt(e){var t=e.events,n=Object(I.a)().t;return r.a.createElement(D,null,r.a.createElement("p",{className:"client-info-title color-black"},n("liveChat.chat-window.details.calendar-events-title")),r.a.createElement("div",{className:"other-clients-list mb-3"},t.length?t.map((function(e){return r.a.createElement(Wt,{key:e.id,event:e})})):r.a.createElement("div",{className:"text-secondary text-sm-left no-other-chats"},n("liveChat.chat-window.details.no-calendar-events"))))}Wt.propTypes={event:c.a.instanceOf(Vt.a).isRequired},Bt.propTypes={events:c.a.arrayOf(c.a.instanceOf(Vt.a)).isRequired};var Ht=Bt;function Ut(){return(Ut=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Gt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $t(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Kt(e){var t=e.activeClientChannel,n=e.tab,l=Object(I.a)().t,o=Object(u.d)(),c=Gt(Object(a.useState)(!1),2),s=c[0],m=c[1],d=Gt(Object(a.useState)(!1),2),f=d[0],p=d[1],v=C();Object(a.useEffect)((function(){v||p(!1)}),[v]);var h,g=function(){m(!1)},y=Object(a.useCallback)((function(){m((function(e){return!e}))}),[]),E=Object(Ge.useSwipeable)({onSwipedLeft:function(){m(!0)},onSwipedRight:function(){s?g():(p(!0),o(b(null)))}});return f?r.a.createElement(i.a,{to:ht.a.homeRoute.getLink(n)}):(h=v?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"messages-area"},r.a.createElement(Ze,{client:v,href:ht.a.homeRoute.getLink(n),toggleShowDetails:y}),r.a.createElement("div",{className:"messages-area-content pt-xl-4 pt-0"},r.a.createElement(Ue,{client:v,activeClientChannel:t}),r.a.createElement(pt,{client:v,activeClientChannel:t}))),r.a.createElement("div",{className:"client-info-area-wrapper"},r.a.createElement(Ze,{client:v,onClick:g,toggleShowDetails:y}),r.a.createElement("div",{className:"client-info-area small-scrollbar"},r.a.createElement("div",{className:"info-area top-area pt-xl-4 pt-2 pb-4 px-3 mb-3"},r.a.createElement("div",{className:"client-info color-black mb-3"},l("liveChat.chat-window.details.title")),r.a.createElement(Q,{client:v}),r.a.createElement(Me,{assignOperator:v.assignOperator,operator:v.responsibleOperator,clientId:v.id,responsibleOperator:v.responsibleOperator})),r.a.createElement("div",{className:"info-area bottom-area py-4 px-3 mb-3"},r.a.createElement(ne,{service:v.integration.service,variables:v.variables}),v.phone?r.a.createElement(Ft,{clientPhone:v.phone,clients:v.clients_with_same_lead}):null,v.calendar_events.length?r.a.createElement(Ht,{events:v.calendar_events}):null,r.a.createElement(le,{clientId:v.id,tags:v.tags}),r.a.createElement(se,{client:v}),r.a.createElement(jt,{clientId:v.id}))))):r.a.createElement(_,null),r.a.createElement("div",Ut({className:A()("chat-window",{active:!!v,"show-info":s})},E),h))}Kt.propTypes={activeClientChannel:c.a.object,tab:bt};var Qt=Kt,Yt=n("hAFs"),Jt=n("CXWj"),Xt=n("ok1R"),Zt=n("rhny");var en=function(){var e=Object(s.a)(),t=Object(I.a)().t,n=Object(u.d)(),i=e.user_notifications_setting.site_long_notifications,l=e.user_notifications_setting.site_short_notifications;Object(a.useEffect)((function(){j.a.private("User.self.".concat(e.id)).listen("UserNotificationSettingsChanged",(function(t){var a=t.data;n(Object(Yt.a)(e.set("user_notifications_setting",a).toJS()))}))}),[Yt.a,e]);var o=function(t,n){d.a.call("patch","/methods/user/notifications-settings/".concat(e.user_notifications_setting.id),{},function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,n))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Xt.a,null,r.a.createElement(Zt.a,{lg:3,md:4,className:"title-liveChat"},r.a.createElement("span",null,t("liveChat.title"))),r.a.createElement(Zt.a,{lg:2,md:4,className:"d-none d-md-block"},r.a.createElement(Jt.a,{id:"long",label:t("user.notifications.site-long-notifications-label"),name:"site_long_notifications",value:i,setFieldValue:o,errors:{}})),r.a.createElement(Zt.a,{lg:2,md:4,className:"d-none d-md-block"},r.a.createElement(Jt.a,{id:"short",label:t("user.notifications.site-short-notifications-label"),name:"site_short_notifications",value:l,setFieldValue:o,errors:{}}))))},tn=n("h4JF"),nn=n("zwA0");function an(e){var t=e.clientsMap,n=e.clientsIds,a=e.loading,i=e.hasMore,l=e.error,o=e.view,c=e.loadClients,s=e.formatMsgTime,u=o;return!n.size&&a?r.a.createElement(tn.a,null):l?r.a.createElement(nn.a,null):r.a.createElement(u,{clientsMap:t,clientsIds:n,loadMore:function(){!a&&i&&c()},hasMore:i&&!a,formatMsgTime:s})}an.propTypes={clientsMap:c.a.object.isRequired,clientsIds:c.a.object.isRequired,loading:c.a.bool,error:c.a.object,view:c.a.func.isRequired,loadClients:c.a.func.isRequired,formatMsgTime:c.a.func.isRequired,hasMore:c.a.bool};var rn=Object(u.c)((function(e){var t=e.liveChat;return{loading:t.getIn(["allClients","listLoading"]),hasMore:t.getIn(["allClients","hasMore"]),error:t.getIn(["allClients","listLoadingError"]),clientsMap:t.get("clientsMap"),clientsIds:t.getIn(["allClients","ids"])}}),(function(e){return{loadClients:function(){return e(p("allClients"))}}}))(an);function ln(e){var t=e.lastMessage,n=_e(t);return r.a.createElement("div",{className:"d-flex last-message mb-2"},n?r.a.createElement("img",{className:"last-message-author mr-2",src:n,alt:"author img"}):null,t.message?r.a.createElement("div",{className:"message-body color-dark-gray",dangerouslySetInnerHTML:{__html:t.message}}):r.a.createElement(L.t,{className:"icon-size-20 color-gray"}))}function on(e){var t=e.tags;return r.a.createElement(r.a.Fragment,null,t.map((function(e){return r.a.createElement("div",{key:e.id,className:"tag-item mr-1 my-1"},e.name)})))}ln.propTypes={lastMessage:c.a.instanceOf(g.g).isRequired,clientName:c.a.string},on.propTypes={tags:c.a.array.isRequired};var cn=on;function sn(e){var t=e.department;return r.a.createElement("div",{className:"d-inline-block tag-item department mr-1 my-1"},t.name)}sn.propTypes={department:c.a.object.isRequired};var un=sn,mn=n("oI+J"),dn=n("Z7gm"),fn=n("X68C"),pn=n("kvuc");function vn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function hn(e){var t=e.session;return r.a.createElement("p",{className:"mb-2 text-middle"},t.url)}function gn(e){var t=e.sessions,n=vn(Object(a.useState)(!1),2),i=n[0],l=n[1],o=t[0],c=t.slice(1);return r.a.createElement("div",null,r.a.createElement(hn,{key:"session-".concat(o.id),session:o}),c.length?r.a.createElement(mn.a,{className:"session-dropdown",isOpen:i,toggle:function(){return l((function(e){return!e}))}},r.a.createElement(dn.a,{className:"session-btn text-middle py-1 px-2",color:"outline-secondary",caret:!0},"+",c.length),r.a.createElement(fn.a,null,c.map((function(e){return r.a.createElement(pn.a,{className:"session-dropdown-item",key:"session-".concat(e.id),toggle:!1},r.a.createElement(hn,{session:e}))})))):null)}hn.propTypes={session:c.a.shape({id:c.a.number.isRequired,url:c.a.string.isRequired}).isRequired},gn.propTypes={sessions:c.a.array.isRequired};var yn=gn;var En=function(){var e=Object(I.a)().t;return r.a.createElement("div",{className:"d-inline-block tag-item skipped mr-1 my-1"},e("skipped"))};function On(e){var t=e.client,n=e.tab,a=e.showSessions,i=e.formatMsgTime,l=t.integration.service,o=t.lastMessage,c=t.name,s=t.id,u=t.tags,m=t.department,d=t.has_skipped_live_chat_request,f=t.variables,p=t.active_sessions;return r.a.createElement($e.a,{to:ht.a.chatRoute.getLink(n,s),className:"d-flex chat-list-item-content pb-1"},r.a.createElement("div",{className:"service-icon-block"},r.a.createElement("span",null,Ye.b[l]())),r.a.createElement("div",{className:"chat-list-info"},r.a.createElement("div",{className:"d-flex justify-content-between align-items-center w-100 mb-2"},r.a.createElement("span",null,c),o?r.a.createElement("span",{className:"date color-dark-gray"},i(o.created_at)):null),f&&r.a.createElement(Qe,{variables:f,integrationType:l}),o?r.a.createElement(ln,{lastMessage:o,clientName:c}):null,r.a.createElement("div",{className:"d-flex flex-wrap"},d?r.a.createElement(En,null):null,m?r.a.createElement(un,{department:m}):null,r.a.createElement(cn,{tags:u})),a&&p.length?r.a.createElement(yn,{sessions:p}):null))}On.propTypes={client:c.a.instanceOf(f.a).isRequired,tab:bt,showSessions:c.a.bool,formatMsgTime:c.a.func.isRequired};var wn=r.a.memo(On);function jn(e){var t=e.client,n=e.waitingLiveChat,a=e.isActive,i=e.tab,l=e.showSessions,o=e.formatMsgTime;return r.a.createElement("li",{id:t.id,className:A()("chat-list-item pt-3 pb-2 px-3",{active:a,"waiting-for-live-chat":n})},r.a.createElement(wn,{client:t,tab:i,showSessions:l,formatMsgTime:o}))}jn.propTypes={client:c.a.instanceOf(f.a).isRequired,waitingLiveChat:c.a.bool,isActive:c.a.bool,tab:bt,showSessions:c.a.bool,formatMsgTime:c.a.func.isRequired};var Cn=Object(u.c)((function(e,t){var n;return{isActive:(null===(n=e.liveChat.get("activeClientId"))||void 0===n?void 0:n.toString())===t.client.id.toString()}}))(jn);function Nn(e){var t=e.clientsMap,n=e.clientsIds,i=e.loadMore,l=e.hasMore,o=e.formatMsgTime,c=Object(a.useRef)(),s=Object(I.a)().t;return r.a.createElement("div",{ref:c,className:"chat-list view small-scrollbar"},r.a.createElement(Ae.a,{pageStart:0,loadMore:i,hasMore:l,loader:null,useWindow:!1,getScrollParent:function(){return c.current}},r.a.createElement("ul",{className:"list-unstyled"},n.map((function(e){var n=t.get(e);return r.a.createElement(Cn,{key:n.id,client:n,tab:vt.a,formatMsgTime:o})})))),n.size?null:r.a.createElement("div",{className:"mt-4 text-center text-middle"},s("liveChat.chats-panel.no-conversations")))}Nn.propTypes={clientsMap:c.a.object.isRequired,clientsIds:c.a.object.isRequired,loadMore:c.a.func.isRequired,formatMsgTime:c.a.func.isRequired,hasMore:c.a.bool};var Sn=n("2Te1");function Mn(e){var t=e.tab,n=Object(I.a)().t,i=Object(u.e)((function(e){return e.liveChat.get("meta")})),l=Object(u.d)();return Object(a.useEffect)((function(){l(v())}),[l]),r.a.createElement("div",{className:"nav-panel-wrapper chat-list-switcher"},r.a.createElement("div",{className:"nav-panel nav-tabs px-3 w-100 d-flex"},r.a.createElement("div",{className:"nav-panel-item nav-item"},r.a.createElement($e.a,{to:ht.a.homeRoute.getLink(vt.a),className:A()("nav-link w-100  px-2 small",{active:t===vt.a})},n("liveChat.chats-panel.tab-conversations"))),r.a.createElement("div",{className:"nav-panel-item nav-item"},r.a.createElement($e.a,{to:ht.a.homeRoute.getLink(vt.d),className:A()("nav-link w-100  px-2 small",{active:t===vt.d})},n("liveChat.chats-panel.tab-social-queue"),"",!!i.get("skipped")&&r.a.createElement(Sn.a,{pill:!0},i.get("skipped")))),r.a.createElement("div",{className:"nav-panel-item nav-item"},r.a.createElement($e.a,{to:ht.a.homeRoute.getLink(vt.b),className:A()("nav-link w-100 px-2 small",{active:t===vt.b})},n("liveChat.chats-panel.tab-live-queue"),"",!!i.get("liveClients")&&r.a.createElement(Sn.a,{pill:!0,color:"danger"},i.get("liveClients")))),r.a.createElement("div",{className:"nav-panel-item nav-item"},r.a.createElement($e.a,{to:ht.a.homeRoute.getLink(vt.c),className:A()("nav-link px-2 small",{active:t===vt.c})},n("liveChat.chats-panel.tab-online-visitors"),"",!!i.get("onlineClients")&&r.a.createElement(Sn.a,{pill:!0,color:"warning"},i.get("onlineClients"))))))}Mn.propTypes={tab:bt};var Tn=r.a.memo(Mn);function In(e){var t=e.clientsMap,n=e.clientsIds,a=e.loading,i=e.hasMore,l=e.error,o=e.view,c=e.loadClients,s=e.formatMsgTime,u=o;return!n.size&&a?r.a.createElement(tn.a,null):l?r.a.createElement(nn.a,null):r.a.createElement(u,{clientsMap:t,clientsIds:n,loadMore:function(){!a&&i&&c()},hasMore:i&&!a,formatMsgTime:s})}In.propTypes={clientsMap:c.a.object.isRequired,clientsIds:c.a.object.isRequired,loading:c.a.bool,error:c.a.object,view:c.a.func.isRequired,loadClients:c.a.func.isRequired,formatMsgTime:c.a.func.isRequired,hasMore:c.a.bool};var _n=Object(u.c)((function(e){var t=e.liveChat;return{loading:t.getIn(["onlineClients","listLoading"]),hasMore:t.getIn(["onlineClients","hasMore"]),error:t.getIn(["onlineClients","listLoadingError"]),clientsMap:t.get("clientsMap"),clientsIds:t.getIn(["onlineClients","ids"])}}),(function(e){return{loadClients:function(){return e(p("onlineClients"))}}}))(In);function Rn(e){var t=e.clientsMap,n=e.clientsIds,i=e.loadMore,l=e.hasMore,o=e.formatMsgTime,c=Object(a.useRef)(),s=Object(I.a)().t;return r.a.createElement("div",{ref:c,className:"chat-list view small-scrollbar"},r.a.createElement(Ae.a,{pageStart:0,loadMore:i,hasMore:l,loader:null,useWindow:!1,getScrollParent:function(){return c.current}},n.size?r.a.createElement("ul",{className:"list-unstyled mb-0"},n.map((function(e){var n=t.get(e);return r.a.createElement(Cn,{key:n.id,client:n,tab:vt.c,showSessions:!0,formatMsgTime:o})}))):r.a.createElement("div",{className:"mt-4 text-center text-middle"},s("liveChat.chats-panel.no-online-visitors"))))}function kn(e){var t=e.clientsMap,n=e.clientsIds,a=e.loading,i=e.hasMore,l=e.error,o=e.view,c=e.loadClients,s=e.formatMsgTime,u=o;return!n.size&&a?r.a.createElement(tn.a,null):l?r.a.createElement(nn.a,null):r.a.createElement(u,{clientsMap:t,clientsIds:n,loadMore:function(){!a&&i&&c()},hasMore:i&&!a,formatMsgTime:s})}Rn.propTypes={clientsMap:c.a.object.isRequired,clientsIds:c.a.object.isRequired,loadMore:c.a.func.isRequired,formatMsgTime:c.a.func.isRequired,hasMore:c.a.bool},kn.propTypes={clientsMap:c.a.object.isRequired,clientsIds:c.a.object.isRequired,loading:c.a.bool,error:c.a.object,view:c.a.func.isRequired,loadClients:c.a.func.isRequired,formatMsgTime:c.a.func.isRequired,hasMore:c.a.bool};var xn=Object(u.c)((function(e){var t=e.liveChat;return{loading:t.getIn(["liveClients","listLoading"]),hasMore:t.getIn(["liveClients","hasMore"]),error:t.getIn(["liveClients","listLoadingError"]),clientsMap:t.get("clientsMap"),clientsIds:t.getIn(["liveClients","ids"])}}),(function(e){return{loadClients:function(){return e(p("liveClients"))}}}))(kn);function An(e){var t=e.clientsMap,n=e.clientsIds,i=e.loadMore,l=e.hasMore,o=e.formatMsgTime,c=Object(a.useRef)(),u=Object(s.a)(),m=Object(I.a)().t;return r.a.createElement("div",{ref:c,className:"chat-list view small-scrollbar"},r.a.createElement(Ae.a,{pageStart:0,loadMore:i,hasMore:l,loader:null,useWindow:!1,getScrollParent:function(){return c.current}},r.a.createElement("ul",{className:"list-unstyled"},n.map((function(e){var n=t.get(e);return r.a.createElement(Cn,{waitingLiveChat:Boolean(n.assign_operator_id===u.id||n.wait_for_live_chat),key:n.id,client:n,tab:vt.b,formatMsgTime:o})})))),n.size?null:r.a.createElement("div",{className:"mt-4 text-center text-middle"},m("liveChat.chats-panel.no-conversations")))}function qn(e){var t=e.clientsMap,n=e.clientsIds,a=e.loading,i=e.hasMore,l=e.error,o=e.view,c=e.loadClients,s=e.formatMsgTime,u=o;return!n.size&&a?r.a.createElement(tn.a,null):l?r.a.createElement(nn.a,null):r.a.createElement(u,{clientsMap:t,clientsIds:n,loadMore:function(){!a&&i&&c()},hasMore:i&&!a,formatMsgTime:s})}An.propTypes={clientsMap:c.a.object.isRequired,clientsIds:c.a.object.isRequired,loadMore:c.a.func.isRequired,formatMsgTime:c.a.func.isRequired,hasMore:c.a.bool},qn.propTypes={clientsMap:c.a.object.isRequired,clientsIds:c.a.object.isRequired,loading:c.a.bool,error:c.a.object,view:c.a.func.isRequired,loadClients:c.a.func.isRequired,formatMsgTime:c.a.func.isRequired,hasMore:c.a.bool};var Dn=Object(u.c)((function(e){var t=e.liveChat;return{loading:t.getIn(["skipped","listLoading"]),hasMore:t.getIn(["skipped","hasMore"]),error:t.getIn(["skipped","listLoadingError"]),clientsMap:t.get("clientsMap"),clientsIds:t.getIn(["skipped","ids"])}}),(function(e){return{loadClients:function(){return e(p("skipped"))}}}))(qn);function Ln(e){var t=e.clientsMap,n=e.clientsIds,i=e.loadMore,l=e.hasMore,o=e.formatMsgTime,c=Object(a.useRef)(),s=Object(I.a)().t;return r.a.createElement("div",{ref:c,className:"chat-list view small-scrollbar"},r.a.createElement(Ae.a,{pageStart:0,loadMore:i,hasMore:l,loader:null,useWindow:!1,getScrollParent:function(){return c.current}},r.a.createElement("ul",{className:"list-unstyled"},n.map((function(e){var n=t.get(e);return r.a.createElement(Cn,{key:n.id,client:n,tab:vt.d,formatMsgTime:o})})))),n.size?null:r.a.createElement("div",{className:"mt-4 text-center text-middle"},s("liveChat.chats-panel.no-conversations")))}function Pn(e){var t,n=e.tab,a=C(),i=ze(!1);switch(n){case vt.a:t=r.a.createElement(rn,{view:Nn,formatMsgTime:i});break;case vt.c:t=r.a.createElement(_n,{view:Rn,formatMsgTime:i});break;case vt.b:t=r.a.createElement(xn,{view:An,formatMsgTime:i});break;case vt.d:t=r.a.createElement(Dn,{view:Ln,formatMsgTime:i});break;default:t=null}return r.a.createElement("div",{className:A()("chat-list-container",{"d-md-block d-none":!!a})},r.a.createElement(Tn,{tab:n}),t)}Ln.propTypes={clientsMap:c.a.object.isRequired,clientsIds:c.a.object.isRequired,loadMore:c.a.func.isRequired,formatMsgTime:c.a.func.isRequired,hasMore:c.a.bool},Pn.propTypes={tab:bt};var Fn=r.a.memo(Pn),Vn=n("dbgk");function zn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Wn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Bn(){var e=Object(i.j)(),t=e.chatId,n=e.type||vt.a,o=zn(Object(a.useState)(null),2),c=o[0],s=o[1];return r.a.createElement(l.a,null,r.a.createElement("div",{className:"livechat-container"},r.a.createElement(T,{openedChatId:t,setActiveClientChannel:s},r.a.createElement(r.a.Fragment,null,r.a.createElement(Vn.a,null,r.a.createElement(en,null)),r.a.createElement("div",{className:"live-chat-content-container pt-2"},r.a.createElement(Fn,{tab:n}),r.a.createElement(Qt,{tab:n,activeClientChannel:c}))))))}},LEWT:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return y}));var a=n("fOp/"),r=n("Llg8"),i=n("q1tI"),l=n.n(i),o=n("17x9"),c=n.n(o),s=n("DCcX"),u=n("CaDr"),m=n("OBzv"),d=n("sOKU");function f(e){var t=e.text,n=e.onConfirm,a=e.onReject;return l.a.createElement(s.a,{isOpen:!0,toggle:a,className:"confirm-modal"},l.a.createElement(u.a,null,t),l.a.createElement(m.a,null,l.a.createElement(d.a,{color:"primary",onClick:n},"Confirm")," ",l.a.createElement(d.a,{color:"secondary",onClick:a},"Cancel")))}f.propTypes={text:c.a.string.isRequired,onConfirm:c.a.func.isRequired,onReject:c.a.func.isRequired};var p=f,v=n("mNz5"),b=n.n(v),h=function(e){return{type:a.a.ADD,payload:e}},g=function(e){return{type:a.a.REMOVE,payload:e}},y=function(e){return function(t){return new Promise((function(n,a){var i=b()(),o=new r.a({id:i,data:{text:e,onConfirm:n,onReject:a},render:function(){return l.a.createElement(p,{text:e,onConfirm:function(){n(),t(g(i))},onReject:function(){a(),t(g(i))}})}});t(h(o))}))}}},Llg8:function(e,t,n){"use strict";var a=n("Mpt7");function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=u(e);if(t){var r=u(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(s,e);var t,n,a,r=c(s);function s(){return i(this,s),r.apply(this,arguments)}return t=s,a=[{key:"instantiate",value:function(e){return new s(e)}}],(n=null)&&l(t.prototype,n),a&&l(t,a),s}(Object(a.c)({id:null,render:function(){return null}}));t.a=m},T7vI:function(e,t,n){"use strict";var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i),o=n("9Koi"),c=n("zEWu"),s=n("mDHu");function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var f=["ip","geo","first_name","last_name","phone_number","email"];function p(e){var t=e.data,n=Object(o.a)().t,i=m(Object(a.useState)(!1),2),l=i[0],d=i[1],p=[],v=[];for(var b in t)if(t.hasOwnProperty(b)&&null!==t[b]){var h={name:b,value:t[b]};f.includes(b)?p.push(h):v.push(h)}var g=function(e){return Object(c.a)(e)?r.a.createElement(s.a,{geo:e}):Array.isArray(e)?e.join(", "):"object"===u(e)?JSON.stringify(e):e};return r.a.createElement("div",{className:"variable-items"},p.map((function(e){return g(e.value)?r.a.createElement("div",{className:"variable-item",key:e.name},r.a.createElement("span",{className:"item-name font-weight-bold"},e.name,""),r.a.createElement("span",{className:"item-value"},g(e.value))):null})),v.length&&!l?r.a.createElement("button",{type:"button",className:"btn btn-link no-shadow p-0 color-blue text-middle text-dec-none",onClick:function(){return d(!0)}},n("tables.json-show-more",{count:v.length})):null,v.length&&l?v.map((function(e){return g(e.value)?r.a.createElement("div",{className:"variable-item",key:e.name},r.a.createElement("span",{className:"item-name font-weight-bold"},e.name,""),r.a.createElement("span",{className:"item-value"},g(e.value))):null})):null)}p.propTypes={data:l.a.object.isRequired},t.a=p},gQBd:function(e,t,n){"use strict";var a=n("Vjiq");window.io=n("gFX4");var r=new a.a({broadcaster:"socket.io",host:window.location.origin});t.a=r},gmZo:function(e,t,n){"use strict";n("iYuL");var a=n("f0Wu");a.locale(window.locale),t.a=a},mDHu:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i);function o(e){var t=e.geo,n=[];return t.city&&n.push(t.city),t.country&&n.push(t.country),r.a.createElement("div",{className:"d-flex align-items-center"},t.iso?r.a.createElement("img",{className:"flag mr-2",src:"/img/flags/".concat(t.iso.toLowerCase(),".gif"),alt:t.iso}):null,r.a.createElement("div",{className:"location"},n.join(", ")))}o.propTypes={geo:l.a.object.isRequired}},wDsf:function(e,t,n){"use strict";var a=n("q1tI");t.a=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current=e})),t.current}},zEWu:function(e,t,n){"use strict";function a(e){return(null==e?void 0:e.iso)||(null==e?void 0:e.city)||(null==e?void 0:e.country)}n.d(t,"a",(function(){return a}))},zwA0:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("q1tI"),r=n.n(a),i=n("9Koi");function l(){var e=Object(i.a)().t;return r.a.createElement("div",null,e("common.site-error-message"))}}}]);