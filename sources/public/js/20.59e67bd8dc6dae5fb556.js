(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"19iC":function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var a=n("rpa7"),r=n("J3gs"),i=n("YOdH"),l=n("gmZo"),o=n("q1tI");function u(){return function(e){return!e||e.is_am_pm?"hh:mm a":"HH:mm"}(Object(a.a)())}function s(){var e=Object(r.a)();return u()+" "+e}function c(){var e=Object(i.a)(),t=s();return Object(o.useCallback)((function(n){return Object(l.a)(1e3*n).tz(e).format(t)}),[t,e])}},"6jMY":function(e,t,n){"use strict";n.d(t,"b",(function(){return r}));var a=n("MwQV");function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(t){return new Promise((function(n){var r={q:t};e&&(r.type=e),a.a.call("get","/methods/integrations/search",r).data((function(e){n(e.map((function(e){return{label:e.name,value:e.id,integration:e}})))}))}))}}var i=r();t.a=i},"6ukn":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("MwQV");function r(e){return new Promise((function(t){a.a.call("get","/methods/tags/search-company-tags",{q:e}).data((function(e){t(e.map((function(e){return{label:e.name,value:e.id}})))}))}))}},"8WGv":function(e,t,n){"use strict";var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i),o=n("sPdi"),u=n("jrRI"),s=n("3OM0"),c=n("Cs6D"),m=n("TSYQ"),d=n.n(m),f=n("9Koi");function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v={control:function(e){return p(p({},e),{},{"&, &:hover, &:focus":{borderColor:"#ced4da",boxShadow:"none"}})}};function h(e){var t,n,a=e.id,i=e.label,l=e.errors,m=e.name,b=e.setFieldValue,p=e.options,g=e.value,h=e.className,y=e.placeholder,O=e.isClearable,j=e.isDisabled,E=Object(f.a)().t,C=p.findIndex((function(e){return e.value===g})),w=-1===C?null:p[C];return r.a.createElement(u.a,{className:d()(h)},r.a.createElement(s.a,{htmlFor:a},i),r.a.createElement(c.a,{id:a,name:m,isDisabled:j,onChange:function(e){return b(m,e?e.value:null)},options:p,value:w,isClearable:O,className:d()("select-field",{"is-invalid":!!(null===(t=l[m])||void 0===t?void 0:t.length)}),placeholder:y||E("common.default-select-placeholder"),styles:v}),(null===(n=l[m])||void 0===n?void 0:n.length)?r.a.createElement(o.a,{errors:l[m]}):null)}h.defaultProps={isClearable:!0},h.propTypes={errors:l.a.object.isRequired,id:l.a.oneOfType([l.a.string,l.a.number]),value:l.a.oneOfType([l.a.string,l.a.number]),label:l.a.any.isRequired,name:l.a.string.isRequired,setFieldValue:l.a.func.isRequired,options:l.a.array.isRequired,className:l.a.string,placeholder:l.a.string,isClearable:l.a.bool,isDisabled:l.a.bool},t.a=r.a.memo(h)},"Bg/h":function(e,t,n){"use strict";n.d(t,"b",(function(){return p}));var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i),o=n("XRgj"),u=n("8WGv"),s=n("R5y6"),c=n("MwQV");function m(e,t){return new Promise((function(n){c.a.call("get","/methods/clients/search",{q:e,integrationId:t}).data((function(e){n(e.map((function(e){return{label:e.name,value:e.id,client:e}})))}))}))}var d=n("9Koi");function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var p=function(e,t){return e.map((function(e){var n,a,r=e.client,i=[],l=[];switch(t){case o.h:var u,s;if(r.name&&i.push(r.name),r.variables.ip&&i.push(r.variables.ip),l=[],null===(n=r.variables.geo)||void 0===n?void 0:n.city)l.push(null===(u=r.variables.geo)||void 0===u?void 0:u.city);if(null===(a=r.variables.geo)||void 0===a?void 0:a.country)l.push(null===(s=r.variables.geo)||void 0===s?void 0:s.country);return l.length&&i.push(l.join(", ")),{label:i.join(" "),value:e.value};case o.d:case o.g:case o.a:return r.variables.first_name&&i.push(r.variables.first_name),r.variables.last_name&&i.push(r.variables.last_name),{label:i.join(" "),value:e.value};case o.b:case o.c:case o.f:case o.e:return i.push(r.variables.phone_number),r.variables.first_name&&i.push(r.variables.first_name),r.variables.last_name&&i.push(r.variables.last_name),{label:i.join(" "),value:e.value}}}))};function g(e){var t=e.values,n=e.errors,i=e.setFieldValue,l=e.className,c=t.integration,b=f(Object(a.useState)([]),2),g=b[0],v=b[1],h=null==c?void 0:c.value,y=+(null==c?void 0:c.integration.service);Object(a.useEffect)((function(){h&&m("",h).then((function(e){e=p(e,y),v(e)}))}),[h,y]);var O=Object(d.a)().t;return c?+c.integration.service===o.b?r.a.createElement(s.a,{className:l,name:"new_clients",label:O("instantMessages.form.to-label"),value:t.new_clients,setFieldValue:i,errors:n,loadOptions:function(e){return m(e,c.value)},defaultOptions:g,isMulti:!0,isClearable:!0}):r.a.createElement(s.a,{className:l,name:"clients",label:O("instantMessages.form.to-label"),value:t.clients,setFieldValue:i,errors:n,loadOptions:function(e){return m(e,c.value)},defaultOptions:g,isMulti:!0}):r.a.createElement(u.a,{className:l,label:r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,O("instantMessages.form.to-label")),r.a.createElement("div",{className:"sub-label text-middle"},O("instantMessages.form.pick-channel-first"))),name:"clients",value:null,setFieldValue:i,options:[],errors:n,isClearable:!1,isDisabled:!0})}g.propTypes={values:l.a.object.isRequired,errors:l.a.object.isRequired,setFieldValue:l.a.func.isRequired,className:l.a.string};t.a=g},CEGB:function(e,t,n){"use strict";var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i),o=n("sPdi"),u=n("jrRI"),s=n("3OM0"),c=n("TSYQ"),m=n.n(c),d=n("c0+T");function f(e){var t,n,a=e.id,i=e.label,l=e.errors,c=e.name,f=e.className,b=e.value,p=e.setFieldValue,g=e.minDate,v=e.maxDate,h=e.customInput,y=m()({"is-invalid":l&&(null===(t=l[c])||void 0===t?void 0:t.length)});return r.a.createElement(u.a,{className:m()(f)},i?r.a.createElement(s.a,{htmlFor:a},"function"==typeof i?i():i):null,r.a.createElement(d.a,{id:a,name:c,value:b,onChange:function(e){return p(c,e)},formGroupClass:m()("py-0",y),inputClass:y,minDate:g,maxDate:v,customInput:h}),l&&(null===(n=l[c])||void 0===n?void 0:n.length)?r.a.createElement(o.a,{errors:l[c]}):null)}f.propTypes={errors:l.a.object,id:l.a.oneOfType([l.a.string,l.a.number]),label:l.a.any,name:l.a.string.isRequired,className:l.a.string,setFieldValue:l.a.func.isRequired,value:l.a.any,minDate:l.a.object,maxDate:l.a.object,customInput:l.a.any},t.a=r.a.memo(f)},DMen:function(e,t,n){"use strict";n.d(t,"m",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"g",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"d",(function(){return v})),n.d(t,"o",(function(){return h})),n.d(t,"l",(function(){return y})),n.d(t,"c",(function(){return O})),n.d(t,"e",(function(){return j})),n.d(t,"k",(function(){return E})),n.d(t,"r",(function(){return C})),n.d(t,"q",(function(){return w})),n.d(t,"p",(function(){return S})),n.d(t,"t",(function(){return T})),n.d(t,"s",(function(){return _})),n.d(t,"n",(function(){return D})),n.d(t,"f",(function(){return N})),n.d(t,"a",(function(){return I})),n.d(t,"j",(function(){return M})),n.d(t,"b",(function(){return R}));var a=n("STRW"),r=n("MwQV"),i=n("c8c+"),l=n("Qu/B"),o=n("EW+5"),u=Object(o.a)(a.a),s=u.loading,c=u.itemsListLoaded,m=u.error,d=function(e){return{type:a.a.ITEM_LOADED,payload:e}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,n){var a=n().chatbot.get("item");return r.a.call("patch","/methods/chat-bots/".concat(a.get("id")),{temporary:+e},a.toJSON())}},b=function(e,t,n){return function(a){var o={page:e};t.size&&(o.filter=Object(i.a)(t)),n.size&&(o.order=Object(l.a)(n)),a(s()),r.a.call("get","/methods/chat-bots",o,{}).then((function(e){a(c({filters:t,sort:n,response:e}))})).catch((function(e){return a(m(e))}))}},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){n(s()),r.a.call("get","/methods/chat-bots/".concat(e),{temporary:t}).data((function(e){n(d(e))})).catch((function(e){return n(m(e))}))}},g=function(e){return{type:a.a.MOVE,payload:{position:e}}},v=function(e){return{type:a.a.NEW_BLOCK,payload:e}},h=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:a.a.SELECT,payload:{index:e,add:t}}},y=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:a.a.RENDERED,payload:{id:e.toString(),onlySide:t}}},O=function(e){return{type:a.a.START_CONNECTION,payload:{state:e}}},j=function(e,t){return{type:a.a.CREATE_CONNECTION,payload:{from:e,to:t}}},E=function(e){return{type:a.a.REMOVE_CONNECTION,payload:{from:e}}},C=function(e){return{type:a.a.SET_SCALE,payload:{scale:e}}},w=function(e){return{type:a.a.CHANGE_NAME,payload:{name:e}}},S=function(e){return{type:a.a.SET_EDIT,payload:{index:e&&e.toString()}}},T=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return{type:a.a.UPDATE_EDIT,payload:{key:e,value:t,path:n}}},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{type:a.a.UPDATE_CARD_INDEX_EDIT,payload:{key:e,index:t}}},D=function(){return{type:a.a.SAVE_EDIT,payload:{}}},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:a.a.DELETE,payload:{id:e}}},I=function(){return{type:a.a.ADD_BUTTON,payload:{}}},M=function(e){return{type:a.a.REMOVE_BUTTON,payload:{index:e}}},R=function(e){return{type:a.a.CLONE,payload:{index:e}}}},"EW+5":function(e,t,n){"use strict";function a(e){return{loading:function(){return{type:e.LOADING}},error:function(t){return{type:e.LOADING_ERROR,payload:t}},itemsListLoaded:function(t){return{type:e.ITEMS_LOADED,payload:t}}}}n.d(t,"a",(function(){return a}))},FPNo:function(e,t,n){"use strict";var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i),o=n("nc57"),u=n("19iC"),s=n("6Rhw"),c=n("x37D"),m=n("9Koi"),d=n("ok1R"),f=n("rhny"),b=n("MwQV");function p(e){return new Promise((function(t){b.a.call("get","/methods/instant-messages/templates/search",{q:e}).data((function(e){t(e.map((function(e){return{label:e.name,value:e.id,template:e}})))}))}))}var g=n("R5y6"),v=n("bFnZ"),h=n.n(v),y=n("sPdi"),O=n("TSYQ"),j=n.n(O);function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function w(e){var t=e.text,n=e.disabled,i=e.onSending,l=e.onSent,o=Object(m.a)().t,u=E(Object(a.useState)(!1),2),s=u[0],c=u[1],d=E(Object(a.useState)([]),2),f=d[0],p=d[1],g=E(Object(a.useState)(""),2),v=g[0],O=g[1],C=Object(a.useCallback)((function(){i(),b.a.call("post","/methods/instant-messages/templates",{},{name:v,message:t}).validation((function(e,t){p(t.name)})).data((function(){c(!1)})).finally((function(){l()}))}),[v,l,i,t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{show:s,title:o("instantMessages.form.template-name-label"),onConfirm:C,onCancel:function(){return c(!1)},dependencies:[s,O,f,C]},(function(e){return r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",ref:e.setAutoFocusInputRef,className:j()("form-control",{"is-invalid":!!f.length}),value:v,onKeyDown:e.onEnterKeyDownConfirm,onChange:function(e){return O(e.target.value)},placeholder:o("instantMessages.form.template-name-label")}),f.length?r.a.createElement(y.a,{errors:f}):null)})),r.a.createElement("button",{className:"pt-2 px-4 mb-3 btn btn-primary",type:"button",disabled:n||!t,onClick:function(){return c(!0)}},o("instantMessages.form.save-template-btn")))}w.propTypes={text:l.a.string,disabled:l.a.bool,onSending:l.a.func,onSent:l.a.func};var S=w,T=n("6jMY"),_=n("CEGB"),D=n("CXWj"),N=n("INJS"),I=n("Bg/h"),M=n("6ukn"),R=n("AEIT"),x=n("+z1p"),A=n.n(x);n("DMen");function q(e){return function(e){if(Array.isArray(e))return V(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||F(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||F(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){if(e){if("string"==typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(e,t):void 0}}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function k(e){var t,n,i=e.handleSendInstantlyChange,l=e.handleStartChange,o=e.handleTextChange,u=e.handleClientChange,b=e.handleBlur,v=e.handleTagsChange,h=e.values,y=e.errors,O=e.isSubmitting,j=e.handleNameChange,E=e.handleTemplateChange,C=e.handleIntegrationChange,w=e.clientsCount,x=Object(m.a)().t,F=P(Object(a.useState)(!1),2),V=F[0],k=F[1];return r.a.createElement(d.a,null,r.a.createElement(f.a,{md:6},r.a.createElement(s.a,{className:"limiter",id:"name",name:"name",label:x("instantMessages.form.name-label"),placeholder:x("instantMessages.form.name-placeholder"),onChange:j,onBlur:b,value:h.name,errors:y}),r.a.createElement(I.a,{className:"limiter",values:h,errors:y,setFieldValue:u}),r.a.createElement("div",{className:"limiter form-group"},r.a.createElement("label",null,x("instantMessages.form.text-label")),r.a.createElement(R.CKEditor,{editor:A.a,data:h.message,onChange:function(e,t){o(t.getData())},placeholder:x("instantMessages.form.text-placeholder"),config:{toolbar:["bold","italic","underline","link","bulletedList","numberedList","undo","redo"],mention:{feeds:[{marker:"@",feed:function(e){return Promise.resolve([{id:"@".concat(e)}].concat(q([{id:"@first_name"},{id:"@last_name"},{id:"@email"},{id:"@phone_number"}].filter((function(t){return t.id.toLowerCase().includes(e.toLowerCase())})))))}}]}}}))),r.a.createElement(f.a,{md:6},r.a.createElement(g.a,{className:"limiter",name:"tags",label:x("instantMessages.form.tags-label"),value:h.tags,setFieldValue:v,errors:y,loadOptions:M.a,isMulti:!0,isDisabled:Boolean((null===(t=h.clients)||void 0===t?void 0:t.length)||(null===(n=h.new_clients)||void 0===n?void 0:n.length)),isClearable:!1}),r.a.createElement(g.a,{className:"limiter",id:"integration",name:"integration",label:x("instantMessages.form.channel-label"),value:h.integration,setFieldValue:C,errors:y,loadOptions:T.a}),null===w?null:r.a.createElement("div",{className:"sub-label-bottom text-middle mb-4"},x("instantMessages.form.clients-count",{count:w}))),r.a.createElement(f.a,{md:12},r.a.createElement(S,{text:h.message,disabled:!!h.template,onSending:function(){return k(!0)},onSent:function(){return k(!1)}})),r.a.createElement(f.a,{md:6},V?null:r.a.createElement(g.a,{className:"limiter",id:"template",name:"template",label:x("instantMessages.form.template-label"),value:h.template,setFieldValue:E,errors:y,loadOptions:p,cacheOptions:!1}),h.send_instantly?null:r.a.createElement(d.a,null,r.a.createElement(f.a,{sm:6},r.a.createElement(_.a,{id:"start_date",name:"start_date",label:x("instantMessages.form.start-date-label"),value:h.start_date,setFieldValue:l,errors:y,minDate:new Date,showTimeInput:!0})),r.a.createElement(f.a,{sm:6},r.a.createElement(N.a,{id:"start_time",name:"start_time",label:x("instantMessages.form.start-time-label"),value:h.start_time,setFieldValue:l,errors:y,disabled:!h.start_date,date:h.start_date,minTime:new Date}))),r.a.createElement(D.a,{id:"send_instantly",name:"send_instantly",label:x("instantMessages.form.send-instantly-label"),value:h.send_instantly,setFieldValue:i})),r.a.createElement(f.a,{sm:12},r.a.createElement(c.a,{className:"pt-2 px-4 mb-4",disabled:O},x("common.saveBtnText"))))}k.propTypes={handleTagsChange:l.a.func.isRequired,handleSendInstantlyChange:l.a.func.isRequired,handleClientChange:l.a.func.isRequired,handleTextChange:l.a.func.isRequired,handleStartChange:l.a.func.isRequired,handleIntegrationChange:l.a.func.isRequired,handleTemplateChange:l.a.func.isRequired,handleNameChange:l.a.func.isRequired,handleBlur:l.a.func.isRequired,values:l.a.object.isRequired,errors:l.a.object.isRequired,isSubmitting:l.a.bool,clientsCount:l.a.number};var B=k;function L(){return(L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Y(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return J(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function W(e){var t=e.initialData,n=e.handleSubmit,i=e.afterSave,l=Object(a.useCallback)((function(e,t){var a,r,l,o;o=e.new_clients?e.new_clients:e.clients;var u=e.message||null;(null===(a=e.template)||void 0===a?void 0:a.value)&&(u=null);var s={name:e.name||null,message:u,integration_id:(null===(r=e.integration)||void 0===r?void 0:r.value)||null,message_template_id:(null===(l=e.template)||void 0===l?void 0:l.value)||null,send_instantly:~~e.send_instantly,start_date:e.start_date?Math.ceil(e.start_date):null,start_time:e.start_time?Math.ceil(e.start_time):null,tags:e.tags?e.tags.map((function(e){return e.value})):[],clients:o?o.map((function(e){return{id:e.__isNew__?null:e.value,name:e.label}})):[]};n(s).data((function(e){t.setSubmitting(!1),i(e)})).validation((function(e,n){var a={name:n.name,message:n.message,start_time:n.start_time,start_date:n.start_date,template:n.message_template_id,integration:n.integration_id,tags:n.tags,clients:n.clients,new_clients:n.clients};t.setErrors(a),t.setSubmitting(!1)})).catch((function(){t.setSubmitting(!1)}))}),[n,i]),s=Object(u.a)(),c=Object(a.useCallback)((function(e,t){var n;return(n=t||(e||null))?s(n):null}),[s]),m=Object(a.useCallback)((function(e,t,n,a){var r=[];return e&&r.push(e.label),n&&r.push(c(n,a)),t&&r.push(t.label),r.join(" ")}),[c]),d=U(Object(a.useState)(null),2),f=d[0],p=d[1],g=Object(a.useCallback)((function(e,t,n){(null==n?void 0:n.length)?p(n.length):b.a.call("get","/methods/instant-messages/clients-count/".concat(e),{tags:null==t?void 0:t.map((function(e){return e.value}))}).data((function(e){p(e.count)}))}),[]);return r.a.createElement(o.a,{initialValues:G(G({},t),{},{isNameChanged:!1}),handleSubmit:l,renderForm:function(e){var t=e.setFieldValue,n=e.handleChange,a=e.values,i=Y(e,["setFieldValue","handleChange","values"]);return r.a.createElement(B,L({},i,{values:a,handleTagsChange:function(e,n){var r;t(e,n),g(null===(r=a.integration)||void 0===r?void 0:r.value,n,a.clients||a.new_clients)},handleTextChange:function(e){t("message",e),t("template",null)},handleNameChange:function(e){n(e),t("isNameChanged",!!e.target.value)},handleTemplateChange:function(e,n){t(e,n),n?t("message",n.template.message):!n&&a.template&&t("message",""),a.isNameChanged||t("name",m(a.integration,n,a.start_date,a.start_time))},handleIntegrationChange:function(e,n){t(e,n),a.isNameChanged||t("name",m(n,a.template,a.start_date,a.start_time)),n||(t("clients",null),t("new_clients",null)),g(n?n.value:null,a.tags,a.clients||a.new_clients)},handleStartChange:function(e,n){t(e,n),a.isNameChanged||t("name",m(a.integration,a.template,"start_date"===e?n:a.start_date,"start_time"===e?n:a.start_time))},handleSendInstantlyChange:function(e,n){t(e,n),a.isNameChanged||t("name",m(a.integration,a.template,n?null:a.start_date,n?null:a.start_time))},handleClientChange:function(e,n){var r;t(e,n),n&&n.length&&t("tags",null),g(null===(r=a.integration)||void 0===r?void 0:r.value,a.tags,n)},clientsCount:f}))}})}W.propTypes={initialData:l.a.object.isRequired,handleSubmit:l.a.func.isRequired,afterSave:l.a.func.isRequired};t.a=W},INJS:function(e,t,n){"use strict";var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i),o=n("sPdi"),u=n("jrRI"),s=n("3OM0"),c=n("TSYQ"),m=n.n(c),d=n("NRhA"),f=n.n(d),b=n("Opvh"),p=(n("5Buo"),n("19iC"));function g(e){var t=e.value,n=e.onChange,i=e.customInput,l=e.placeholder,o=e.formGroupClass,s=e.inputClass,c=e.minTime,g=e.maxTime,v=e.disabled,h=e.date;Object(a.useEffect)((function(){Object(d.registerLocale)(window.locale,b[window.locale])}),[]);var y=Object(p.c)();return r.a.createElement(u.a,{className:m()(o)},r.a.createElement(f.a,{selected:t?new Date(1e3*t):null,onChange:function(e){return n(e.getTime()/1e3)},className:m()("form-control",s),dateFormat:y,customInput:i,placeholderText:l,locale:window.locale,showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:1,timeFormat:y,filterTime:function(e){var t;return h?((t=new Date(1e3*h)).setHours(e.getHours()),t.setMinutes(e.getMinutes())):t=new Date(e),c&&g?c.getTime()<t.getTime()&&t.getTime()<g.getTime():c?c.getTime()<t.getTime():!g||t.getTime()<g.getTime()},disabled:v}))}function v(e){var t,n,a=e.id,i=e.label,l=e.errors,c=e.name,d=e.className,f=e.value,b=e.setFieldValue,p=e.minTime,v=e.maxTime,h=e.disabled,y=e.date,O=m()({"is-invalid":l&&(null===(t=l[c])||void 0===t?void 0:t.length)});return r.a.createElement(u.a,{className:m()(d)},i?r.a.createElement(s.a,{htmlFor:a},"function"==typeof i?i():i):null,r.a.createElement(g,{id:a,name:c,value:f,onChange:function(e){return b(c,e)},formGroupClass:m()("py-0",O),inputClass:O,minTime:p,maxTime:v,disabled:h,date:y}),l&&(null===(n=l[c])||void 0===n?void 0:n.length)?r.a.createElement(o.a,{errors:l[c]}):null)}g.propTypes={onChange:l.a.func.isRequired,customInput:l.a.any,value:l.a.number,placeholder:l.a.string,formGroupClass:l.a.string,inputClass:l.a.string,minTime:l.a.object,maxTime:l.a.object,disabled:l.a.bool,date:l.a.number},v.propTypes={errors:l.a.object,id:l.a.oneOfType([l.a.string,l.a.number]),label:l.a.any,name:l.a.string.isRequired,className:l.a.string,setFieldValue:l.a.func.isRequired,value:l.a.any,minTime:l.a.object,maxTime:l.a.object,disabled:l.a.bool,date:l.a.number};t.a=r.a.memo(v)},"Qu/B":function(e,t,n){"use strict";function a(e){return e.map((function(e){return e.get("sort")})).toArray().join(",")}n.d(t,"a",(function(){return a}))},R5y6:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n("q1tI"),r=n.n(a),i=n("QDav"),l=n("xilt"),o=n("jrRI"),u=n("3OM0"),s=n("TSYQ"),c=n.n(s),m=n("sPdi"),d=n("17x9"),f=n.n(d),b=n("9Koi");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h={control:function(e){return g(g({},e),{},{"&, &:hover, &:focus":{borderColor:"#ced4da",boxShadow:"none"}})}};function y(e){var t,n,a=e.id,s=e.label,d=e.errors,f=e.loadOptions,p=e.name,g=e.setFieldValue,v=e.handleBlur,y=e.value,O=e.className,j=e.placeholder,E=e.isClearable,C=e.cacheOptions,w=e.isMulti,S=e.isDisabled,T=e.defaultOptions,_=Object(b.a)().t,D=E?l.a:i.a;return r.a.createElement(o.a,{className:c()(O)},r.a.createElement(u.a,{htmlFor:a},s),r.a.createElement(D,{cacheOptions:C,defaultOptions:T,loadOptions:f,onChange:function(e){g(p,e)},value:y,isClearable:E,className:c()({"is-invalid":!!(null===(t=d[p])||void 0===t?void 0:t.length)}),placeholder:j||_("common.default-select-placeholder"),styles:h,isMulti:w,isDisabled:S,onBlur:v}),(null===(n=d[p])||void 0===n?void 0:n.length)?r.a.createElement(m.a,{errors:d[p]}):null)}y.defaultProps={isClearable:!0,cacheOptions:!0,defaultOptions:!0},y.propTypes={errors:f.a.object.isRequired,id:f.a.oneOfType([f.a.string,f.a.number]),value:f.a.oneOfType([f.a.shape({label:f.a.string,value:f.a.oneOfType([f.a.string,f.a.number])}),f.a.array]),label:f.a.any.isRequired,name:f.a.string.isRequired,handleBlur:f.a.func,setFieldValue:f.a.func.isRequired,loadOptions:f.a.func.isRequired,className:f.a.string,placeholder:f.a.string,isClearable:f.a.bool,isMulti:f.a.bool,isDisabled:f.a.bool,cacheOptions:f.a.bool,defaultOptions:f.a.oneOfType([f.a.bool,f.a.array])}},"SKh+":function(e,t,n){"use strict";n.r(t);var a=n("q1tI"),r=n.n(a),i=n("dbgk"),l=n("TtP3"),o=n("FPNo"),u=n("MwQV"),s=n("Ty5D"),c=n("h4JF"),m=n("XRgj"),d=n("Bg/h"),f=n("9Koi"),b=n("BLzl"),p=n("/kxI");function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done)&&(n.push(l.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}t.default=function(){var e=Object(f.a)().t,t=g(Object(a.useState)(null),2),n=t[0],v=t[1],h=g(Object(a.useState)(null),2),y=h[0],O=h[1],j=Object(s.j)().id;Object(a.useEffect)((function(){u.a.call("get","/methods/instant-messages/".concat(j)).data((function(e){v(e)}))}),[j]);var E,C=Object(a.useCallback)((function(e){return u.a.call("patch","/methods/instant-messages/".concat(j),{},e)}),[j]),w=Object(a.useCallback)((function(){O("/instant-messages/1")}),[]);if(null!==y)return r.a.createElement(s.a,{to:y});if(n){var S=null,T=null,_=n.clients.map((function(e){return{label:e.name,value:e.id,client:e}}));+n.integration.service===m.b?T=Object(d.b)(_,+n.integration.service):S=Object(d.b)(_,+n.integration.service),E=r.a.createElement(o.a,{afterSave:w,handleSubmit:C,initialData:{name:n.name,message:n.message||"",integration:{label:n.integration.name,value:n.integration.id,integration:n.integration},template:n.message_template?{label:n.message_template.name,value:n.message_template.id,template:n.message_template}:null,start_date:+n.start_at,start_time:+n.start_at,tags:n.tags.map((function(e){return{label:e.name,value:e.id}})),clients:S,new_clients:T,integration_type:null,send_instantly:!n.start_at}})}else E=r.a.createElement(c.a,null);return r.a.createElement(l.a,null,r.a.createElement(i.a,null,e("instantMessages.edit-title")),r.a.createElement(b.a,{className:"instant-messages-view mb-4 shadow"},r.a.createElement(p.a,{className:"px-4 rounded"},E)))}},"c0+T":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i),o=n("jrRI"),u=n("NRhA"),s=n.n(u),c=n("Opvh"),m=n("J3gs");n("5Buo");var d=n("TSYQ"),f=n.n(d);function b(e){var t=e.value,n=e.onChange,i=e.customInput,l=e.placeholder,d=e.formGroupClass,b=e.inputClass,p=e.minDate,g=e.maxDate;Object(a.useEffect)((function(){Object(u.registerLocale)(window.locale,c[window.locale])}),[]);var v=function(e){switch(e){case"MM/DD/YYYY":return"MM/dd/yyyy";case"DD.MM.YYYY":return"dd.MM.yyyy"}}(Object(m.a)());return r.a.createElement(o.a,{className:f()(d)},r.a.createElement(s.a,{selected:t?new Date(1e3*t):null,onChange:function(e){return n(e?Math.ceil(e.getTime()/1e3):null)},className:f()("form-control",b),dateFormat:v,customInput:i,placeholderText:l,locale:window.locale,minDate:p,maxDate:g}))}b.propTypes={onChange:l.a.func.isRequired,customInput:l.a.any,value:l.a.number,placeholder:l.a.string,formGroupClass:l.a.string,inputClass:l.a.string,minDate:l.a.object,maxDate:l.a.object}},"c8c+":function(e,t,n){"use strict";function a(e){var t=e.map((function(e){return{column:e.get("column"),operator:e.get("operator"),value:e.get("value")}})).toArray();return JSON.stringify(t)}n.d(t,"a",(function(){return a}))},dbgk:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("q1tI"),r=n.n(a),i=n("17x9"),l=n.n(i);function o(e){var t=e.children;return r.a.createElement("h1",{className:"title-main mb-3"},t)}o.propTypes={children:l.a.any.isRequired}},gmZo:function(e,t,n){"use strict";n("iYuL");var a=n("f0Wu");a.locale(window.locale),t.a=a},xilt:function(e,t,n){"use strict";n("q1tI"),n("qKvR"),n("i8i4"),n("17x9");var a=n("njTy"),r=(n("iYmT"),n("FUBA"),n("1m/E")),i=n("QDav"),l=n("vwsU"),o=Object(l.b)(a.a),u=Object(r.a)(o),s=Object(i.b)(u);t.a=s}}]);